(he3) ➜  CryptoNets git:(fboemer/cryptonets-timings) ✗ ./run_python_timings_encrypt_model_13.sh
TensorFlow version installed: 1.12.0 (v1.12.0-0-ga6d8ffae09)
nGraph bridge built with: 1.12.0 (v1.12.0-0-ga6d8ffae09)
Extracting /tmp/tensorflow/mnist/input_data/train-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/train-labels-idx1-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-labels-idx1-ubyte.gz
2018-11-27 15:02:26.244021: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2018-11-27 15:02:26.279386: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:02:26.279427: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:02:26.279438: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:02:26.279448: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:02:26.279457: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:02:26.279467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:02:26.279478: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:02:26.279488: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:02:26.279498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:02:26.279509: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:02:26.279519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:02:26.279529: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:02:26.279538: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:02:26.279549: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:02:26.279557: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:02:26.279563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:02:26.279571: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:02:26.279577: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:02:26.279584: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:02:26.279599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:02:26.279650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:02:26.279670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:02:26.279679: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:02:26.279687: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:02:26.279698: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:02:26.279707: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:02:26.279716: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:02:26.279725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:02:26.279734: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:02:26.279743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:02:26.279752: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:02:26.279761: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:02:26.279770: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:02:26.279779: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:02:26.279788: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:02:26.279798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:02:26.279808: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:02:26.279886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:02:26.279909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:02:26.279927: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:02:26.279941: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:02:26.279956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:02:26.279973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:02:26.279988: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:02:26.280008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:02:26.280022: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:02:26.280045: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:02:26.280059: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:02:26.280080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:02:26.280096: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:02:26.280110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:02:26.280131: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:02:26.280140: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:02:26.280148: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:02:26.280156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:02:26.280178: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:02:26.280186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:02:26.280195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:02:26.280202: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:02:26.280209: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:02:26.280214: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:02:26.280231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d450 :: reshape/Reshape/shape [Const]
2018-11-27 15:02:26.280239: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d4c8 :: conv1/Const [Const]
2018-11-27 15:02:26.280246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d540 :: conv1/pad_const [Const]
2018-11-27 15:02:26.280253: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d5b8 :: fc1/Reshape/shape [Const]
2018-11-27 15:02:26.280260: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d630 :: squash/Const [Const]
2018-11-27 15:02:26.280267: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d6a8 :: fc2/Const [Const]
2018-11-27 15:02:26.280274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d720 :: reshape/Reshape [Reshape]
2018-11-27 15:02:26.280281: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d7d8 :: conv1/Conv2D [Conv2D]
2018-11-27 15:02:26.280288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d890 :: conv1/Square [Square]
2018-11-27 15:02:26.280295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d928 :: conv1/Pad [Pad]
2018-11-27 15:02:26.280302: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2d9e0 :: fc1/Reshape [Reshape]
2018-11-27 15:02:26.280309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2da98 :: fc1/MatMul [MatMul]
2018-11-27 15:02:26.280316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2db50 :: fc1/Square [Square]
2018-11-27 15:02:26.280323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3e2dbe8 :: fc2/MatMul [MatMul]
2018-11-27 15:02:26.280396: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:02:26.280447: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 0 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:02:26.280483: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:02:26.280522: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:02:26.280533: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 0, datatype: 1
2018-11-27 15:02:26.282083: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:02:26.282117: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:02:26z src/seal/ckks/he_seal_ckks_backend.cpp 66	Using SEAL CKKS config with 7 30-bit coefficients
[INFO] 2018-11-27T23:02:27z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:02:27.434670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 0
2018-11-27 15:02:27.434746: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:02:27.434761: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 0
2018-11-27 15:02:27.434776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_0
2018-11-27 15:02:27.434913: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:02:27.435040: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:02:27.435071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:02:27.435099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:02:27.435149: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:02:27.435202: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:02:27.435221: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:02:27.435229: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:02:27.435235: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:02:27.435241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:02:27.435256: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:02:27.435288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:02:27.435295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:02:27.435302: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:02:27.435311: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:02:27.435342: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:02:27.435355: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:02:27.435363: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:02:27.435484: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:02:27.435519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:02:27.435568: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:02:27.435603: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:02:27.435624: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:02:27.435633: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:02:27.435640: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:02:27.435696: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:02:27.435725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:02:27.435738: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:02:27.435752: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:02:27.435786: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:02:27.436567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:02:27.436625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:02:27.436662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:02:27.436703: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:02:27.436828: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 0
2018-11-27 15:02:27.436858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 0
[INFO] 2018-11-27T23:02:27z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:02:27.876931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 0
[INFO] 2018-11-27T23:02:27z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:02:27.924403: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 0
2018-11-27 15:02:27.924476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 0
[INFO] 2018-11-27T23:02:27z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:02:27z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:02:27z src/he_backend.cpp 319	[ Parameter_0 ]
[INFO] 2018-11-27T23:02:27z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:02:27z src/he_backend.cpp 319	[ Constant_17 ]
[INFO] 2018-11-27T23:02:27z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:02:27z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:28z src/he_backend.cpp 395	Constant_17 took 493ms
[INFO] 2018-11-27T23:02:28z src/he_backend.cpp 319	[ Constant_14 ]
[INFO] 2018-11-27T23:02:28z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:02:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 395	Constant_14 took 8183ms
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 319	[ Constant_10 ]
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 395	Constant_10 took 26ms
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 319	[ Constant_3 ]
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 395	Constant_3 took 44ms
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 319	[ Reshape_2 ]
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 395	Reshape_2 took 0ms
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 319	[ Reshape_5 ]
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 395	Reshape_5 took 0ms
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 319	[ Reshape_4 ]
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 395	Reshape_4 took 0ms
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 319	[ Convolution_6 ]
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:02:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:40z src/he_backend.cpp 395	Convolution_6 took 3603ms
[INFO] 2018-11-27T23:02:40z src/he_backend.cpp 319	[ Reshape_7 ]
[INFO] 2018-11-27T23:02:40z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:02:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:40z src/he_backend.cpp 395	Reshape_7 took 0ms
[INFO] 2018-11-27T23:02:40z src/he_backend.cpp 319	[ Multiply_8 ]
[INFO] 2018-11-27T23:02:40z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:02:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 395	Multiply_8 took 528ms
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 319	[ Pad_11 ]
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 395	Pad_11 took 0ms
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 319	[ Reshape_13 ]
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 395	Reshape_13 took 0ms
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 319	[ Dot_15 ]
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:02:41z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 395	Dot_15 took 46935ms
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 319	[ Multiply_16 ]
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 395	Multiply_16 took 74ms
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 319	[ Dot_18 ]
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 395	Dot_18 took 690ms
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 319	[ Result_19 ]
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:03:28z src/he_backend.cpp 395	Result_19 took 2ms
2018-11-27 15:03:28.874026: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 0
2018-11-27 15:03:28.975497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 0
Result
[[-5.35247231 -4.86890507 8.99101162 6.6469965 -1.42178786 -3.71283913 -14.697588 16.9264469 5.14660263 10.5426006]]
total time warmup: 62.70848727226257
2018-11-27 15:03:28.988702: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:03:28.988838: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:03:28.988914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:03:28.988985: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:03:28.989054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:03:28.989111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:03:28.989169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:03:28.989225: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:03:28.989280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:03:28.989339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:03:28.989395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:03:28.989451: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:03:28.989506: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:03:28.989562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:03:28.989615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:03:28.989664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:03:28.989715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:03:28.989763: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:03:28.989815: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:03:28.989863: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:03:28.989973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:03:28.990045: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:03:28.990112: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:03:28.990167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:03:28.990228: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:03:28.990284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:03:28.990343: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:03:28.990399: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:03:28.990465: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:03:28.990517: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:03:28.990568: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:03:28.990621: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:03:28.990673: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:03:28.990725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:03:28.990776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:03:28.990828: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:03:28.990881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:03:28.991029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:03:28.991104: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:03:28.991170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:03:28.991231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:03:28.991299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:03:28.991365: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:03:28.991428: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:03:28.991498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:03:28.991559: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:03:28.991633: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:03:28.991695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:03:28.991766: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:03:28.991832: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:03:28.991893: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:03:28.991962: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:03:28.992014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:03:28.992064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:03:28.992114: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:03:28.992185: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:03:28.992235: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:03:28.992284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:03:28.992333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:03:28.992391: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:03:28.992456: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:03:28.992517: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bb9c0 :: reshape/Reshape/shape [Const]
2018-11-27 15:03:28.992531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bba38 :: conv1/Const [Const]
2018-11-27 15:03:28.992561: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbab0 :: conv1/pad_const [Const]
2018-11-27 15:03:28.992574: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbb28 :: fc1/Reshape/shape [Const]
2018-11-27 15:03:28.992586: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbba0 :: squash/Const [Const]
2018-11-27 15:03:28.992598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbc18 :: fc2/Const [Const]
2018-11-27 15:03:28.992609: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbc90 :: reshape/Reshape [Reshape]
2018-11-27 15:03:28.992625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbd48 :: conv1/Conv2D [Conv2D]
2018-11-27 15:03:28.992637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbe00 :: conv1/Square [Square]
2018-11-27 15:03:28.992650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbe98 :: conv1/Pad [Pad]
2018-11-27 15:03:28.992660: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bbf50 :: fc1/Reshape [Reshape]
2018-11-27 15:03:28.992671: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bc008 :: fc1/MatMul [MatMul]
2018-11-27 15:03:28.992682: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bc0c0 :: fc1/Square [Square]
2018-11-27 15:03:28.992700: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x67bc158 :: fc2/MatMul [MatMul]
2018-11-27 15:03:28.992803: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:03:28.992876: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 1 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:03:28.992954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:03:28.993007: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:03:28.993022: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 1, datatype: 1
2018-11-27 15:03:28.994027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:03:28.994045: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:03:30z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:03:30.145323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 1
2018-11-27 15:03:30.145371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:03:30.145381: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 1
2018-11-27 15:03:30.145388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_1
2018-11-27 15:03:30.145477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:03:30.145541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:03:30.145562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:03:30.145584: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:03:30.145621: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:03:30.145669: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:03:30.145686: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:03:30.145693: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:03:30.145699: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:03:30.145705: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:03:30.145716: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:03:30.145745: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:03:30.145753: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:03:30.145760: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:03:30.145768: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:03:30.145794: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:03:30.145807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:03:30.145814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:03:30.145909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:03:30.145941: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:03:30.145983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:03:30.146016: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:03:30.146038: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:03:30.146047: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:03:30.146054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:03:30.146106: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:03:30.146134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:03:30.146147: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:03:30.146160: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:03:30.146192: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:03:30.146858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:03:30.146907: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:03:30.146941: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:03:30.146983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:03:30.147105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 1
2018-11-27 15:03:30.147126: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 1
[INFO] 2018-11-27T23:03:30z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:03:30.292414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 1
[INFO] 2018-11-27T23:03:30z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:03:30.328415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 1
2018-11-27 15:03:30.328436: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 1
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 319	[ Parameter_20 ]
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 319	[ Constant_37 ]
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 395	Constant_37 took 213ms
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 319	[ Constant_34 ]
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:03:30z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:41z src/he_backend.cpp 395	Constant_34 took 11381ms
[INFO] 2018-11-27T23:03:41z src/he_backend.cpp 319	[ Constant_30 ]
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 395	Constant_30 took 34ms
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 319	[ Constant_23 ]
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 395	Constant_23 took 69ms
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 319	[ Reshape_22 ]
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 395	Reshape_22 took 0ms
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 319	[ Reshape_25 ]
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 395	Reshape_25 took 0ms
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 319	[ Reshape_24 ]
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 395	Reshape_24 took 0ms
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 319	[ Convolution_26 ]
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:03:42z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 395	Convolution_26 took 3771ms
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 319	[ Reshape_27 ]
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 395	Reshape_27 took 0ms
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 319	[ Multiply_28 ]
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 395	Multiply_28 took 387ms
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 319	[ Pad_31 ]
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 395	Pad_31 took 0ms
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 319	[ Reshape_33 ]
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 395	Reshape_33 took 0ms
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 319	[ Dot_35 ]
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:03:46z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 395	Dot_35 took 37985ms
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 319	[ Multiply_36 ]
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 395	Multiply_36 took 65ms
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 319	[ Dot_38 ]
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:24z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:04:25z src/he_backend.cpp 395	Dot_38 took 577ms
[INFO] 2018-11-27T23:04:25z src/he_backend.cpp 319	[ Result_39 ]
[INFO] 2018-11-27T23:04:25z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:04:25z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:04:25z src/he_backend.cpp 395	Result_39 took 2ms
2018-11-27 15:04:25.294300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 1
2018-11-27 15:04:25.446076: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 1
Result
[[-5.56839371 -5.0299325 9.29589748 6.59649467 -1.13224244 -3.69328022 -14.7088947 17.0493507 5.57725906 10.6622009]]
total time trial 1: 56.46714186668396
2018-11-27 15:04:25.456946: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:04:25.457060: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:04:25.457132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:04:25.457199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:04:25.457260: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:04:25.457314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:04:25.457368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:04:25.457421: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:04:25.457474: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:04:25.457530: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:04:25.457584: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:04:25.457637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:04:25.457689: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:04:25.457741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:04:25.457792: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:04:25.457838: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:04:25.457888: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:04:25.457934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:04:25.457983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:04:25.458028: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:04:25.458132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:04:25.458196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:04:25.458248: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:04:25.458299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:04:25.458351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:04:25.458403: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:04:25.458454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:04:25.458505: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:04:25.458556: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:04:25.458607: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:04:25.458658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:04:25.458709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:04:25.458759: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:04:25.458810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:04:25.458860: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:04:25.458911: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:04:25.458963: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:04:25.459107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:04:25.459181: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:04:25.459246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:04:25.459307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:04:25.459368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:04:25.459432: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:04:25.459493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:04:25.459562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:04:25.459622: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:04:25.459695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:04:25.459756: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:04:25.459825: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:04:25.459888: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:04:25.459949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:04:25.459982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:04:25.459995: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:04:25.460018: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:04:25.460036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:04:25.460072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:04:25.460084: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:04:25.460100: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:04:25.460125: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:04:25.460134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:04:25.460143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:04:25.460167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3880 :: reshape/Reshape/shape [Const]
2018-11-27 15:04:25.460179: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b38f8 :: conv1/Const [Const]
2018-11-27 15:04:25.460190: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3970 :: conv1/pad_const [Const]
2018-11-27 15:04:25.460201: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b39e8 :: fc1/Reshape/shape [Const]
2018-11-27 15:04:25.460212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3a60 :: squash/Const [Const]
2018-11-27 15:04:25.460223: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3ad8 :: fc2/Const [Const]
2018-11-27 15:04:25.460234: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3b50 :: reshape/Reshape [Reshape]
2018-11-27 15:04:25.460245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3c08 :: conv1/Conv2D [Conv2D]
2018-11-27 15:04:25.460256: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3cc0 :: conv1/Square [Square]
2018-11-27 15:04:25.460267: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3d58 :: conv1/Pad [Pad]
2018-11-27 15:04:25.460277: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3e10 :: fc1/Reshape [Reshape]
2018-11-27 15:04:25.460288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3ec8 :: fc1/MatMul [MatMul]
2018-11-27 15:04:25.460299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b3f80 :: fc1/Square [Square]
2018-11-27 15:04:25.460309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x67b4018 :: fc2/MatMul [MatMul]
2018-11-27 15:04:25.460410: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:04:25.460481: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 2 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:04:25.460532: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:04:25.460587: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:04:25.460603: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 2, datatype: 1
2018-11-27 15:04:25.461621: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:04:25.461644: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:04:26z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:04:26.665320: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 2
2018-11-27 15:04:26.665422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:04:26.665453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 2
2018-11-27 15:04:26.665477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_2
2018-11-27 15:04:26.665631: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:04:26.665715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:04:26.665741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:04:26.665768: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:04:26.665807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:04:26.665857: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:04:26.665877: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:04:26.665884: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:04:26.665890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:04:26.665896: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:04:26.665909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:04:26.665944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:04:26.665952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:04:26.665959: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:04:26.665968: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:04:26.665993: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:04:26.666006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:04:26.666014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:04:26.666110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:04:26.666144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:04:26.666188: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:04:26.666221: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:04:26.666245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:04:26.666255: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:04:26.666262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:04:26.666322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:04:26.666350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:04:26.666364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:04:26.666377: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:04:26.666412: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:04:26.667233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:04:26.667283: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:04:26.667320: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:04:26.667360: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:04:26.667480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 2
2018-11-27 15:04:26.667502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 2
[INFO] 2018-11-27T23:04:26z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:04:26.713037: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 2
[INFO] 2018-11-27T23:04:26z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:04:26.713541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 2
2018-11-27 15:04:26.713553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 2
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 319	[ Parameter_40 ]
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 319	[ Constant_57 ]
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 395	Constant_57 took 200ms
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 319	[ Constant_54 ]
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:04:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 395	Constant_54 took 13210ms
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 319	[ Constant_50 ]
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 395	Constant_50 took 5ms
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 319	[ Constant_43 ]
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 395	Constant_43 took 41ms
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 319	[ Reshape_42 ]
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 395	Reshape_42 took 0ms
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 319	[ Reshape_45 ]
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 395	Reshape_45 took 0ms
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 319	[ Reshape_44 ]
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 395	Reshape_44 took 0ms
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 319	[ Convolution_46 ]
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:04:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 395	Convolution_46 took 4291ms
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 319	[ Reshape_47 ]
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 395	Reshape_47 took 0ms
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 319	[ Multiply_48 ]
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 395	Multiply_48 took 302ms
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 319	[ Pad_51 ]
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 395	Pad_51 took 0ms
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 319	[ Reshape_53 ]
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 395	Reshape_53 took 0ms
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 319	[ Dot_55 ]
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:04:44z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 395	Dot_55 took 37661ms
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 319	[ Multiply_56 ]
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 395	Multiply_56 took 75ms
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 319	[ Dot_58 ]
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:22z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:05:23z src/he_backend.cpp 395	Dot_58 took 657ms
[INFO] 2018-11-27T23:05:23z src/he_backend.cpp 319	[ Result_59 ]
[INFO] 2018-11-27T23:05:23z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:05:23z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:05:23z src/he_backend.cpp 395	Result_59 took 2ms
2018-11-27 15:05:23.190728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 2
2018-11-27 15:05:23.292071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 2
Result
[[17.4705162 -0.958097756 -2.88015294 4.38177681 -10.8970652 -6.48497391 -19.4540291 20.7015553 -9.97699833 -8.24328899]]
total time trial 2: 57.84291338920593
2018-11-27 15:05:23.301241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:05:23.301270: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:05:23.301280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:05:23.301289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:05:23.301296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:05:23.301305: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:05:23.301318: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:05:23.301333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:05:23.301343: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:05:23.301355: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:05:23.301365: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:05:23.301375: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:05:23.301384: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:05:23.301393: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:05:23.301402: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:05:23.301408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:05:23.301416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:05:23.301422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:05:23.301430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:05:23.301436: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:05:23.301481: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:05:23.301499: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:05:23.301508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:05:23.301517: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:05:23.301526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:05:23.301535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:05:23.301544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:05:23.301553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:05:23.301562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:05:23.301571: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:05:23.301580: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:05:23.301589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:05:23.301598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:05:23.301606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:05:23.301615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:05:23.301624: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:05:23.301634: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:05:23.301704: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:05:23.301727: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:05:23.301744: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:05:23.301759: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:05:23.301773: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:05:23.301791: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:05:23.301805: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:05:23.301825: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:05:23.301839: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:05:23.301862: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:05:23.301876: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:05:23.301897: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:05:23.301913: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:05:23.301927: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:05:23.301948: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:05:23.301956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:05:23.301965: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:05:23.301973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:05:23.301995: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:05:23.302003: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:05:23.302011: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:05:23.302019: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:05:23.302025: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:05:23.302031: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:05:23.302044: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b9260 :: reshape/Reshape/shape [Const]
2018-11-27 15:05:23.302052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b92d8 :: conv1/Const [Const]
2018-11-27 15:05:23.302059: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b9350 :: conv1/pad_const [Const]
2018-11-27 15:05:23.302066: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b93c8 :: fc1/Reshape/shape [Const]
2018-11-27 15:05:23.302073: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b9440 :: squash/Const [Const]
2018-11-27 15:05:23.302080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b94b8 :: fc2/Const [Const]
2018-11-27 15:05:23.302087: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b9530 :: reshape/Reshape [Reshape]
2018-11-27 15:05:23.302095: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b95e8 :: conv1/Conv2D [Conv2D]
2018-11-27 15:05:23.302102: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b96a0 :: conv1/Square [Square]
2018-11-27 15:05:23.302109: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b9738 :: conv1/Pad [Pad]
2018-11-27 15:05:23.302116: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b97f0 :: fc1/Reshape [Reshape]
2018-11-27 15:05:23.302123: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b98a8 :: fc1/MatMul [MatMul]
2018-11-27 15:05:23.302131: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b9960 :: fc1/Square [Square]
2018-11-27 15:05:23.302138: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x67b99f8 :: fc2/MatMul [MatMul]
2018-11-27 15:05:23.302203: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:05:23.302252: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 3 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:05:23.302287: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:05:23.302322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:05:23.302333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 3, datatype: 1
2018-11-27 15:05:23.303796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:05:23.303839: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:05:24z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:05:24.479556: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 3
2018-11-27 15:05:24.479591: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:05:24.479600: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 3
2018-11-27 15:05:24.479606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_3
2018-11-27 15:05:24.479687: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:05:24.479753: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:05:24.479776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:05:24.479798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:05:24.479834: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:05:24.479884: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:05:24.479901: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:05:24.479909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:05:24.479914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:05:24.479920: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:05:24.479931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:05:24.479961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:05:24.479968: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:05:24.479975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:05:24.479983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:05:24.480008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:05:24.480036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:05:24.480045: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:05:24.480138: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:05:24.480171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:05:24.480212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:05:24.480245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:05:24.480267: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:05:24.480276: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:05:24.480283: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:05:24.480335: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:05:24.480374: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:05:24.480388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:05:24.480401: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:05:24.480434: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:05:24.481035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:05:24.481085: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:05:24.481122: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:05:24.481165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:05:24.481293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 3
2018-11-27 15:05:24.481314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 3
[INFO] 2018-11-27T23:05:24z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:05:24.534219: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 3
[INFO] 2018-11-27T23:05:24z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:05:24.534697: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 3
2018-11-27 15:05:24.534709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 3
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 319	[ Parameter_60 ]
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 319	[ Constant_77 ]
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 395	Constant_77 took 157ms
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 319	[ Constant_74 ]
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:05:24z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 395	Constant_74 took 11493ms
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 319	[ Constant_70 ]
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 395	Constant_70 took 5ms
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 319	[ Constant_63 ]
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 395	Constant_63 took 28ms
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 319	[ Reshape_62 ]
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 395	Reshape_62 took 0ms
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 319	[ Reshape_65 ]
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 395	Reshape_65 took 0ms
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 319	[ Reshape_64 ]
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 395	Reshape_64 took 0ms
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 319	[ Convolution_66 ]
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:05:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 395	Convolution_66 took 3835ms
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 319	[ Reshape_67 ]
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 395	Reshape_67 took 0ms
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 319	[ Multiply_68 ]
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 395	Multiply_68 took 573ms
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 319	[ Pad_71 ]
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 395	Pad_71 took 0ms
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 319	[ Reshape_73 ]
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 395	Reshape_73 took 0ms
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 319	[ Dot_75 ]
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:05:40z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 395	Dot_75 took 35069ms
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 319	[ Multiply_76 ]
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 395	Multiply_76 took 62ms
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 319	[ Dot_78 ]
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:15z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:06:16z src/he_backend.cpp 395	Dot_78 took 547ms
[INFO] 2018-11-27T23:06:16z src/he_backend.cpp 319	[ Result_79 ]
[INFO] 2018-11-27T23:06:16z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:06:16z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:06:16z src/he_backend.cpp 395	Result_79 took 2ms
2018-11-27 15:06:16.334548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 3
2018-11-27 15:06:16.451084: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 3
Result
[[-1.6648128 -3.66259861 6.54084682 6.74703741 -3.60164499 -3.91005611 -15.2037334 17.2334366 1.83333886 8.09724236]]
total time trial 3: 53.15656304359436
2018-11-27 15:06:16.461348: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:06:16.461395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:06:16.461405: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:06:16.461414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:06:16.461422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:06:16.461432: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:06:16.461446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:06:16.461456: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:06:16.461484: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:06:16.461497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:06:16.461509: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:06:16.461520: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:06:16.461529: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:06:16.461539: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:06:16.461548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:06:16.461555: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:06:16.461563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:06:16.461569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:06:16.461577: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:06:16.461583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:06:16.461642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:06:16.461661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:06:16.461670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:06:16.461679: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:06:16.461688: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:06:16.461697: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:06:16.461706: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:06:16.461715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:06:16.461724: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:06:16.461733: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:06:16.461742: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:06:16.461751: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:06:16.461759: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:06:16.461768: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:06:16.461777: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:06:16.461786: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:06:16.461796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:06:16.461877: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:06:16.461902: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:06:16.461921: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:06:16.461935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:06:16.461950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:06:16.461967: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:06:16.461982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:06:16.462002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:06:16.462016: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:06:16.462039: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:06:16.462053: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:06:16.462074: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:06:16.462090: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:06:16.462105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:06:16.462126: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:06:16.462134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:06:16.462143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:06:16.462150: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:06:16.462172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:06:16.462180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:06:16.462189: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:06:16.462196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:06:16.462203: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:06:16.462208: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:06:16.462225: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b7f00 :: reshape/Reshape/shape [Const]
2018-11-27 15:06:16.462233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b7f78 :: conv1/Const [Const]
2018-11-27 15:06:16.462241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b7ff0 :: conv1/pad_const [Const]
2018-11-27 15:06:16.462247: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b8068 :: fc1/Reshape/shape [Const]
2018-11-27 15:06:16.462255: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b80e0 :: squash/Const [Const]
2018-11-27 15:06:16.462262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b8158 :: fc2/Const [Const]
2018-11-27 15:06:16.462268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b81d0 :: reshape/Reshape [Reshape]
2018-11-27 15:06:16.462275: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b8288 :: conv1/Conv2D [Conv2D]
2018-11-27 15:06:16.462282: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b8340 :: conv1/Square [Square]
2018-11-27 15:06:16.462290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b83d8 :: conv1/Pad [Pad]
2018-11-27 15:06:16.462297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b8490 :: fc1/Reshape [Reshape]
2018-11-27 15:06:16.462304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b8548 :: fc1/MatMul [MatMul]
2018-11-27 15:06:16.462311: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b8600 :: fc1/Square [Square]
2018-11-27 15:06:16.462318: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x67b8698 :: fc2/MatMul [MatMul]
2018-11-27 15:06:16.462382: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:06:16.462432: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 4 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:06:16.462465: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:06:16.462504: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:06:16.462516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 4, datatype: 1
2018-11-27 15:06:16.463751: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:06:16.463776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:06:17z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:06:17.621917: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 4
2018-11-27 15:06:17.622033: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:06:17.622103: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 4
2018-11-27 15:06:17.622127: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_4
2018-11-27 15:06:17.622294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:06:17.622456: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:06:17.622520: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:06:17.622581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:06:17.622694: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:06:17.622809: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:06:17.622867: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:06:17.622893: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:06:17.622912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:06:17.622931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:06:17.622967: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:06:17.623065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:06:17.623088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:06:17.623095: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:06:17.623105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:06:17.623134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:06:17.623148: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:06:17.623156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:06:17.623252: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:06:17.623289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:06:17.623334: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:06:17.623374: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:06:17.623399: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:06:17.623409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:06:17.623416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:06:17.623471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:06:17.623504: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:06:17.623519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:06:17.623534: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:06:17.623569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:06:17.624280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:06:17.624337: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:06:17.624386: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:06:17.624436: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:06:17.624571: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 4
2018-11-27 15:06:17.624592: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 4
[INFO] 2018-11-27T23:06:17z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:06:17.655411: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 4
[INFO] 2018-11-27T23:06:17z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:06:17.655815: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 4
2018-11-27 15:06:17.655830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 4
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 319	[ Parameter_80 ]
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 319	[ Constant_97 ]
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 395	Constant_97 took 245ms
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 319	[ Constant_94 ]
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:06:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 395	Constant_94 took 9022ms
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 319	[ Constant_90 ]
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 395	Constant_90 took 5ms
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 319	[ Constant_83 ]
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 395	Constant_83 took 53ms
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 319	[ Reshape_82 ]
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 395	Reshape_82 took 0ms
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 319	[ Reshape_85 ]
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 395	Reshape_85 took 0ms
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 319	[ Reshape_84 ]
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 395	Reshape_84 took 0ms
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 319	[ Convolution_86 ]
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:06:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:30z src/he_backend.cpp 395	Convolution_86 took 3653ms
[INFO] 2018-11-27T23:06:30z src/he_backend.cpp 319	[ Reshape_87 ]
[INFO] 2018-11-27T23:06:30z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:06:30z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:30z src/he_backend.cpp 395	Reshape_87 took 0ms
[INFO] 2018-11-27T23:06:30z src/he_backend.cpp 319	[ Multiply_88 ]
[INFO] 2018-11-27T23:06:30z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:06:30z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 395	Multiply_88 took 487ms
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 319	[ Pad_91 ]
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 395	Pad_91 took 0ms
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 319	[ Reshape_93 ]
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 395	Reshape_93 took 0ms
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 319	[ Dot_95 ]
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:06:31z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 395	Dot_95 took 35483ms
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 319	[ Multiply_96 ]
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 395	Multiply_96 took 46ms
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 319	[ Dot_98 ]
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:06z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:07:07z src/he_backend.cpp 395	Dot_98 took 549ms
[INFO] 2018-11-27T23:07:07z src/he_backend.cpp 319	[ Result_99 ]
[INFO] 2018-11-27T23:07:07z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:07:07z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:07:07z src/he_backend.cpp 395	Result_99 took 2ms
2018-11-27 15:07:07.234871: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 4
2018-11-27 15:07:07.342782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 4
Result
[[-2.92768407 -3.84999871 7.17941618 6.87930584 -3.08819222 -3.71238232 -14.9072237 17.0236053 2.63449121 9.21889591]]
total time trial 4: 50.88870310783386
2018-11-27 15:07:07.352953: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:07:07.353029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:07:07.353038: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:07:07.353046: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:07:07.353054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:07:07.353064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:07:07.353086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:07:07.353113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:07:07.353126: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:07:07.353139: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:07:07.353149: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:07:07.353159: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:07:07.353168: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:07:07.353178: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:07:07.353186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:07:07.353192: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:07:07.353201: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:07:07.353207: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:07:07.353216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:07:07.353222: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:07:07.353277: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:07:07.353296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:07:07.353321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:07:07.353330: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:07:07.353340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:07:07.353348: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:07:07.353357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:07:07.353366: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:07:07.353376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:07:07.353385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:07:07.353393: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:07:07.353402: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:07:07.353411: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:07:07.353420: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:07:07.353429: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:07:07.353438: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:07:07.353448: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:07:07.353527: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:07:07.353550: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:07:07.353568: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:07:07.353582: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:07:07.353597: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:07:07.353614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:07:07.353629: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:07:07.353649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:07:07.353664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:07:07.353686: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:07:07.353701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:07:07.353722: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:07:07.353738: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:07:07.353752: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:07:07.353774: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:07:07.353782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:07:07.353791: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:07:07.353799: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:07:07.353821: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:07:07.353830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:07:07.353838: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:07:07.353846: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:07:07.353853: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:07:07.353858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:07:07.353872: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a4e00 :: reshape/Reshape/shape [Const]
2018-11-27 15:07:07.353880: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a4e78 :: conv1/Const [Const]
2018-11-27 15:07:07.353887: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a4ef0 :: conv1/pad_const [Const]
2018-11-27 15:07:07.353895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a4f68 :: fc1/Reshape/shape [Const]
2018-11-27 15:07:07.353902: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a4fe0 :: squash/Const [Const]
2018-11-27 15:07:07.353909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a5058 :: fc2/Const [Const]
2018-11-27 15:07:07.353916: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a50d0 :: reshape/Reshape [Reshape]
2018-11-27 15:07:07.353923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a5188 :: conv1/Conv2D [Conv2D]
2018-11-27 15:07:07.353931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a5240 :: conv1/Square [Square]
2018-11-27 15:07:07.353938: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a52d8 :: conv1/Pad [Pad]
2018-11-27 15:07:07.353945: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a5390 :: fc1/Reshape [Reshape]
2018-11-27 15:07:07.353952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a5448 :: fc1/MatMul [MatMul]
2018-11-27 15:07:07.353960: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a5500 :: fc1/Square [Square]
2018-11-27 15:07:07.353967: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x67a5598 :: fc2/MatMul [MatMul]
2018-11-27 15:07:07.354033: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:07:07.354084: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 5 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:07:07.354119: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:07:07.354158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:07:07.354169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 5, datatype: 1
2018-11-27 15:07:07.356078: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:07:07.356134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:07:08z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:07:08.571737: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 5
2018-11-27 15:07:08.571779: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:07:08.571790: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 5
2018-11-27 15:07:08.571796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_5
2018-11-27 15:07:08.571908: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:07:08.572001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:07:08.572032: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:07:08.572055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:07:08.572093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:07:08.572144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:07:08.572162: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:07:08.572170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:07:08.572175: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:07:08.572181: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:07:08.572192: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:07:08.572223: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:07:08.572230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:07:08.572237: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:07:08.572245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:07:08.572271: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:07:08.572284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:07:08.572291: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:07:08.572390: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:07:08.572424: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:07:08.572464: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:07:08.572498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:07:08.572524: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:07:08.572533: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:07:08.572540: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:07:08.572592: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:07:08.572622: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:07:08.572635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:07:08.572647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:07:08.572680: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:07:08.573311: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:07:08.573371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:07:08.573408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:07:08.573455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:07:08.573585: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 5
2018-11-27 15:07:08.573604: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 5
[INFO] 2018-11-27T23:07:08z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:07:08.607045: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 5
[INFO] 2018-11-27T23:07:08z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:07:08.607635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 5
2018-11-27 15:07:08.607668: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 5
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 319	[ Parameter_100 ]
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 319	[ Constant_117 ]
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 395	Constant_117 took 251ms
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 319	[ Constant_114 ]
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:07:08z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:17z src/he_backend.cpp 395	Constant_114 took 9068ms
[INFO] 2018-11-27T23:07:17z src/he_backend.cpp 319	[ Constant_110 ]
[INFO] 2018-11-27T23:07:17z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:07:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:17z src/he_backend.cpp 395	Constant_110 took 5ms
[INFO] 2018-11-27T23:07:17z src/he_backend.cpp 319	[ Constant_103 ]
[INFO] 2018-11-27T23:07:17z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:07:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 395	Constant_103 took 72ms
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 319	[ Reshape_102 ]
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 395	Reshape_102 took 0ms
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 319	[ Reshape_105 ]
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 395	Reshape_105 took 0ms
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 319	[ Reshape_104 ]
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 395	Reshape_104 took 0ms
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 319	[ Convolution_106 ]
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:07:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:21z src/he_backend.cpp 395	Convolution_106 took 3793ms
[INFO] 2018-11-27T23:07:21z src/he_backend.cpp 319	[ Reshape_107 ]
[INFO] 2018-11-27T23:07:21z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:07:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:21z src/he_backend.cpp 395	Reshape_107 took 0ms
[INFO] 2018-11-27T23:07:21z src/he_backend.cpp 319	[ Multiply_108 ]
[INFO] 2018-11-27T23:07:21z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:07:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 395	Multiply_108 took 316ms
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 319	[ Pad_111 ]
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 395	Pad_111 took 0ms
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 319	[ Reshape_113 ]
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 395	Reshape_113 took 0ms
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 319	[ Dot_115 ]
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:22z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 395	Dot_115 took 35453ms
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 319	[ Multiply_116 ]
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 395	Multiply_116 took 69ms
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 319	[ Dot_118 ]
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:57z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:07:58z src/he_backend.cpp 395	Dot_118 took 542ms
[INFO] 2018-11-27T23:07:58z src/he_backend.cpp 319	[ Result_119 ]
[INFO] 2018-11-27T23:07:58z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:07:58z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:07:58z src/he_backend.cpp 395	Result_119 took 2ms
2018-11-27 15:07:58.209521: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 5
2018-11-27 15:07:58.312086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 5
Result
[[6.28086 -1.67348158 1.67108572 6.43044281 -7.75506067 -4.63069 -16.6121845 18.129427 -4.56823969 2.16003966]]
total time trial 5: 50.966859102249146
2018-11-27 15:07:58.322176: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:07:58.322206: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:07:58.322216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:07:58.322225: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:07:58.322232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:07:58.322241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:07:58.322256: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:07:58.322272: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:07:58.322284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:07:58.322297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:07:58.322307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:07:58.322318: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:07:58.322328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:07:58.322337: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:07:58.322346: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:07:58.322352: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:07:58.322360: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:07:58.322366: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:07:58.322374: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:07:58.322380: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:07:58.322424: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:07:58.322441: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:07:58.322450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:07:58.322459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:07:58.322468: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:07:58.322477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:07:58.322486: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:07:58.322495: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:07:58.322505: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:07:58.322514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:07:58.322523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:07:58.322532: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:07:58.322541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:07:58.322549: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:07:58.322558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:07:58.322567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:07:58.322577: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:07:58.322650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:07:58.322671: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:07:58.322689: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:07:58.322703: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:07:58.322719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:07:58.322736: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:07:58.322751: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:07:58.322771: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:07:58.322785: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:07:58.322808: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:07:58.322822: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:07:58.322843: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:07:58.322860: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:07:58.322874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:07:58.322895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:07:58.322903: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:07:58.322912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:07:58.322920: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:07:58.322942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:07:58.322950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:07:58.322959: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:07:58.322967: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:07:58.322974: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:07:58.322979: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:07:58.322993: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7140 :: reshape/Reshape/shape [Const]
2018-11-27 15:07:58.323001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b71b8 :: conv1/Const [Const]
2018-11-27 15:07:58.323008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7230 :: conv1/pad_const [Const]
2018-11-27 15:07:58.323015: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b72a8 :: fc1/Reshape/shape [Const]
2018-11-27 15:07:58.323022: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7320 :: squash/Const [Const]
2018-11-27 15:07:58.323030: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7398 :: fc2/Const [Const]
2018-11-27 15:07:58.323037: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7410 :: reshape/Reshape [Reshape]
2018-11-27 15:07:58.323044: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b74c8 :: conv1/Conv2D [Conv2D]
2018-11-27 15:07:58.323051: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7580 :: conv1/Square [Square]
2018-11-27 15:07:58.323058: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7618 :: conv1/Pad [Pad]
2018-11-27 15:07:58.323065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b76d0 :: fc1/Reshape [Reshape]
2018-11-27 15:07:58.323072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7788 :: fc1/MatMul [MatMul]
2018-11-27 15:07:58.323080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b7840 :: fc1/Square [Square]
2018-11-27 15:07:58.323087: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x67b78d8 :: fc2/MatMul [MatMul]
2018-11-27 15:07:58.323153: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:07:58.323200: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 6 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:07:58.323233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:07:58.323267: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:07:58.323278: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 6, datatype: 1
2018-11-27 15:07:58.325201: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:07:58.325224: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:07:59z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:07:59.547738: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 6
2018-11-27 15:07:59.547783: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:07:59.547794: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 6
2018-11-27 15:07:59.547800: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_6
2018-11-27 15:07:59.547883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:07:59.547950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:07:59.547973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:07:59.547994: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:07:59.548033: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:07:59.548083: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:07:59.548099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:07:59.548107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:07:59.548113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:07:59.548118: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:07:59.548131: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:07:59.548159: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:07:59.548167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:07:59.548173: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:07:59.548182: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:07:59.548208: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:07:59.548220: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:07:59.548227: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:07:59.548316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:07:59.548350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:07:59.548401: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:07:59.548437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:07:59.548460: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:07:59.548469: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:07:59.548476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:07:59.548528: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:07:59.548557: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:07:59.548570: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:07:59.548584: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:07:59.548616: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:07:59.549277: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:07:59.549329: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:07:59.549368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:07:59.549418: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:07:59.549548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 6
2018-11-27 15:07:59.549568: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 6
[INFO] 2018-11-27T23:07:59z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:07:59.572389: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 6
[INFO] 2018-11-27T23:07:59z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:07:59.572878: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 6
2018-11-27 15:07:59.572915: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 6
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 319	[ Parameter_120 ]
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 319	[ Constant_137 ]
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 395	Constant_137 took 209ms
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 319	[ Constant_134 ]
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:07:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 395	Constant_134 took 8934ms
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 319	[ Constant_130 ]
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 395	Constant_130 took 5ms
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 319	[ Constant_123 ]
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 395	Constant_123 took 51ms
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 319	[ Reshape_122 ]
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 395	Reshape_122 took 0ms
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 319	[ Reshape_125 ]
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 395	Reshape_125 took 0ms
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 319	[ Reshape_124 ]
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 395	Reshape_124 took 0ms
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 319	[ Convolution_126 ]
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:08:08z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:12z src/he_backend.cpp 395	Convolution_126 took 3922ms
[INFO] 2018-11-27T23:08:12z src/he_backend.cpp 319	[ Reshape_127 ]
[INFO] 2018-11-27T23:08:12z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:08:12z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:12z src/he_backend.cpp 395	Reshape_127 took 0ms
[INFO] 2018-11-27T23:08:12z src/he_backend.cpp 319	[ Multiply_128 ]
[INFO] 2018-11-27T23:08:12z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:08:12z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 395	Multiply_128 took 321ms
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 319	[ Pad_131 ]
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 395	Pad_131 took 0ms
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 319	[ Reshape_133 ]
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 395	Reshape_133 took 0ms
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 319	[ Dot_135 ]
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:13z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 395	Dot_135 took 35971ms
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 319	[ Multiply_136 ]
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 395	Multiply_136 took 34ms
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 319	[ Dot_138 ]
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 395	Dot_138 took 533ms
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 319	[ Result_139 ]
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:08:49z src/he_backend.cpp 395	Result_139 took 1ms
2018-11-27 15:08:49.588274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 6
2018-11-27 15:08:49.708743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 6
Result
[[-1.74568915 -3.72167778 6.44878101 6.65843916 -3.6737504 -3.97887397 -15.2503099 17.128376 1.74070311 8.02818394]]
total time trial 6: 51.39458441734314
2018-11-27 15:08:49.721152: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:08:49.721201: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:08:49.721212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:08:49.721221: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:08:49.721229: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:08:49.721240: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:08:49.721263: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:08:49.721274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:08:49.721287: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:08:49.721301: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:08:49.721309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:08:49.721320: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:08:49.721329: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:08:49.721339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:08:49.721347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:08:49.721354: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:08:49.721362: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:08:49.721368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:08:49.721376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:08:49.721382: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:08:49.721443: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:08:49.721463: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:08:49.721472: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:08:49.721481: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:08:49.721490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:08:49.721499: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:08:49.721508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:08:49.721517: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:08:49.721526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:08:49.721535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:08:49.721544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:08:49.721553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:08:49.721562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:08:49.721571: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:08:49.721580: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:08:49.721588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:08:49.721598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:08:49.721684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:08:49.721709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:08:49.721728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:08:49.721742: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:08:49.721757: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:08:49.721774: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:08:49.721788: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:08:49.721808: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:08:49.721822: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:08:49.721845: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:08:49.721859: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:08:49.721879: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:08:49.721895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:08:49.721910: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:08:49.721931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:08:49.721939: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:08:49.721948: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:08:49.721956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:08:49.721978: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:08:49.721986: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:08:49.721994: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:08:49.722002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:08:49.722008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:08:49.722014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:08:49.722028: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48aa0 :: reshape/Reshape/shape [Const]
2018-11-27 15:08:49.722036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48b18 :: conv1/Const [Const]
2018-11-27 15:08:49.722043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48b90 :: conv1/pad_const [Const]
2018-11-27 15:08:49.722050: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48c08 :: fc1/Reshape/shape [Const]
2018-11-27 15:08:49.722057: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48c80 :: squash/Const [Const]
2018-11-27 15:08:49.722064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48cf8 :: fc2/Const [Const]
2018-11-27 15:08:49.722072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48d70 :: reshape/Reshape [Reshape]
2018-11-27 15:08:49.722078: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48e28 :: conv1/Conv2D [Conv2D]
2018-11-27 15:08:49.722086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48ee0 :: conv1/Square [Square]
2018-11-27 15:08:49.722093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a48f78 :: conv1/Pad [Pad]
2018-11-27 15:08:49.722100: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a49030 :: fc1/Reshape [Reshape]
2018-11-27 15:08:49.722107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a490e8 :: fc1/MatMul [MatMul]
2018-11-27 15:08:49.722114: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a491a0 :: fc1/Square [Square]
2018-11-27 15:08:49.722121: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x6a49238 :: fc2/MatMul [MatMul]
2018-11-27 15:08:49.722185: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:08:49.722241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 7 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:08:49.722280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:08:49.722328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:08:49.722340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 7, datatype: 1
2018-11-27 15:08:49.723630: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:08:49.723660: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:08:50z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:08:50.886111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 7
2018-11-27 15:08:50.886164: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:08:50.886174: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 7
2018-11-27 15:08:50.886182: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_7
2018-11-27 15:08:50.886289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:08:50.886365: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:08:50.886389: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:08:50.886415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:08:50.886455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:08:50.886503: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:08:50.886521: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:08:50.886528: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:08:50.886534: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:08:50.886540: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:08:50.886551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:08:50.886581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:08:50.886588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:08:50.886595: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:08:50.886603: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:08:50.886629: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:08:50.886642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:08:50.886649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:08:50.886743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:08:50.886775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:08:50.886816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:08:50.886851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:08:50.886873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:08:50.886882: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:08:50.886889: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:08:50.886941: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:08:50.886970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:08:50.886983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:08:50.886996: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:08:50.887029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:08:50.887830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:08:50.887881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:08:50.887918: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:08:50.887961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:08:50.888088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 7
2018-11-27 15:08:50.888108: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 7
[INFO] 2018-11-27T23:08:50z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:08:50.911062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 7
[INFO] 2018-11-27T23:08:50z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:08:50.911342: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 7
2018-11-27 15:08:50.911354: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 7
[INFO] 2018-11-27T23:08:50z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:08:50z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:08:50z src/he_backend.cpp 319	[ Parameter_140 ]
[INFO] 2018-11-27T23:08:50z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:08:50z src/he_backend.cpp 319	[ Constant_157 ]
[INFO] 2018-11-27T23:08:50z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:08:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:51z src/he_backend.cpp 395	Constant_157 took 182ms
[INFO] 2018-11-27T23:08:51z src/he_backend.cpp 319	[ Constant_154 ]
[INFO] 2018-11-27T23:08:51z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:08:51z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 395	Constant_154 took 8775ms
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 319	[ Constant_150 ]
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 395	Constant_150 took 5ms
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 319	[ Constant_143 ]
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 395	Constant_143 took 45ms
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 319	[ Reshape_142 ]
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 395	Reshape_142 took 0ms
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 319	[ Reshape_145 ]
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 395	Reshape_145 took 0ms
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 319	[ Reshape_144 ]
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 395	Reshape_144 took 0ms
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 319	[ Convolution_146 ]
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:08:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:03z src/he_backend.cpp 395	Convolution_146 took 3855ms
[INFO] 2018-11-27T23:09:03z src/he_backend.cpp 319	[ Reshape_147 ]
[INFO] 2018-11-27T23:09:03z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:09:03z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:03z src/he_backend.cpp 395	Reshape_147 took 0ms
[INFO] 2018-11-27T23:09:03z src/he_backend.cpp 319	[ Multiply_148 ]
[INFO] 2018-11-27T23:09:03z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:09:03z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 395	Multiply_148 took 515ms
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 319	[ Pad_151 ]
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 395	Pad_151 took 1ms
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 319	[ Reshape_153 ]
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 395	Reshape_153 took 0ms
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 319	[ Dot_155 ]
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:04z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 395	Dot_155 took 37532ms
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 319	[ Multiply_156 ]
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 395	Multiply_156 took 69ms
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 319	[ Dot_158 ]
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:41z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:09:42z src/he_backend.cpp 395	Dot_158 took 563ms
[INFO] 2018-11-27T23:09:42z src/he_backend.cpp 319	[ Result_159 ]
[INFO] 2018-11-27T23:09:42z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:09:42z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:09:42z src/he_backend.cpp 395	Result_159 took 1ms
2018-11-27 15:09:42.488207: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 7
2018-11-27 15:09:42.610340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 7
Result
[[0.154401332 -3.11897898 5.21588755 6.70851231 -4.77208376 -4.06188726 -15.5213499 17.3197479 0.0714035705 6.79688025]]
total time trial 7: 52.89669585227966
2018-11-27 15:09:42.619749: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:09:42.619791: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:09:42.619801: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:09:42.619810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:09:42.619818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:09:42.619826: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:09:42.619841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:09:42.619854: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:09:42.619867: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:09:42.619880: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:09:42.619889: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:09:42.619901: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:09:42.619910: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:09:42.619919: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:09:42.619928: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:09:42.619934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:09:42.619942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:09:42.619948: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:09:42.619956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:09:42.619962: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:09:42.620017: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:09:42.620036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:09:42.620045: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:09:42.620053: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:09:42.620063: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:09:42.620072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:09:42.620080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:09:42.620089: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:09:42.620098: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:09:42.620107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:09:42.620115: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:09:42.620124: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:09:42.620133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:09:42.620141: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:09:42.620150: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:09:42.620159: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:09:42.620169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:09:42.620246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:09:42.620269: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:09:42.620286: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:09:42.620300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:09:42.620315: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:09:42.620333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:09:42.620347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:09:42.620374: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:09:42.620388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:09:42.620411: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:09:42.620425: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:09:42.620446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:09:42.620462: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:09:42.620476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:09:42.620497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:09:42.620506: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:09:42.620514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:09:42.620522: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:09:42.620544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:09:42.620553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:09:42.620561: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:09:42.620569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:09:42.620576: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:09:42.620581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:09:42.620598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a390 :: reshape/Reshape/shape [Const]
2018-11-27 15:09:42.620606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a408 :: conv1/Const [Const]
2018-11-27 15:09:42.620613: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a480 :: conv1/pad_const [Const]
2018-11-27 15:09:42.620620: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a4f8 :: fc1/Reshape/shape [Const]
2018-11-27 15:09:42.620627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a570 :: squash/Const [Const]
2018-11-27 15:09:42.620634: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a5e8 :: fc2/Const [Const]
2018-11-27 15:09:42.620641: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a660 :: reshape/Reshape [Reshape]
2018-11-27 15:09:42.620648: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a718 :: conv1/Conv2D [Conv2D]
2018-11-27 15:09:42.620655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a7d0 :: conv1/Square [Square]
2018-11-27 15:09:42.620662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a868 :: conv1/Pad [Pad]
2018-11-27 15:09:42.620670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a920 :: fc1/Reshape [Reshape]
2018-11-27 15:09:42.620676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4a9d8 :: fc1/MatMul [MatMul]
2018-11-27 15:09:42.620684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4aa90 :: fc1/Square [Square]
2018-11-27 15:09:42.620691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6a4ab28 :: fc2/MatMul [MatMul]
2018-11-27 15:09:42.620756: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:09:42.620806: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 8 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:09:42.620841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:09:42.620881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:09:42.620892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 8, datatype: 1
2018-11-27 15:09:42.622515: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:09:42.622577: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:09:43z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:09:43.815541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 8
2018-11-27 15:09:43.815618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:09:43.815636: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 8
2018-11-27 15:09:43.815645: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_8
2018-11-27 15:09:43.815729: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:09:43.815795: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:09:43.815816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:09:43.815839: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:09:43.815876: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:09:43.815924: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:09:43.815941: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:09:43.815949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:09:43.815955: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:09:43.815961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:09:43.815972: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:09:43.816002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:09:43.816010: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:09:43.816017: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:09:43.816025: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:09:43.816052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:09:43.816065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:09:43.816072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:09:43.816164: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:09:43.816197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:09:43.816237: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:09:43.816271: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:09:43.816293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:09:43.816302: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:09:43.816309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:09:43.816369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:09:43.816400: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:09:43.816413: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:09:43.816427: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:09:43.816460: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:09:43.817170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:09:43.817224: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:09:43.817261: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:09:43.817309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:09:43.817444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 8
2018-11-27 15:09:43.817464: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 8
[INFO] 2018-11-27T23:09:43z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:09:43.840567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 8
[INFO] 2018-11-27T23:09:43z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:09:43.841232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 8
2018-11-27 15:09:43.841243: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 8
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 319	[ Parameter_160 ]
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 319	[ Constant_177 ]
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 395	Constant_177 took 152ms
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 319	[ Constant_174 ]
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:09:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 395	Constant_174 took 8911ms
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 319	[ Constant_170 ]
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 395	Constant_170 took 5ms
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 319	[ Constant_163 ]
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 395	Constant_163 took 45ms
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 319	[ Reshape_162 ]
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 395	Reshape_162 took 0ms
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 319	[ Reshape_165 ]
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 395	Reshape_165 took 0ms
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 319	[ Reshape_164 ]
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 395	Reshape_164 took 0ms
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 319	[ Convolution_166 ]
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:09:52z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:56z src/he_backend.cpp 395	Convolution_166 took 4020ms
[INFO] 2018-11-27T23:09:56z src/he_backend.cpp 319	[ Reshape_167 ]
[INFO] 2018-11-27T23:09:56z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:09:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:56z src/he_backend.cpp 395	Reshape_167 took 0ms
[INFO] 2018-11-27T23:09:56z src/he_backend.cpp 319	[ Multiply_168 ]
[INFO] 2018-11-27T23:09:56z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:09:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 395	Multiply_168 took 428ms
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 319	[ Pad_171 ]
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 395	Pad_171 took 0ms
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 319	[ Reshape_173 ]
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 395	Reshape_173 took 0ms
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 319	[ Dot_175 ]
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:09:57z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 395	Dot_175 took 37479ms
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 319	[ Multiply_176 ]
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 395	Multiply_176 took 53ms
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 319	[ Dot_178 ]
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:34z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:10:35z src/he_backend.cpp 395	Dot_178 took 540ms
[INFO] 2018-11-27T23:10:35z src/he_backend.cpp 319	[ Result_179 ]
[INFO] 2018-11-27T23:10:35z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:10:35z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:10:35z src/he_backend.cpp 395	Result_179 took 2ms
2018-11-27 15:10:35.506499: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 8
2018-11-27 15:10:35.605339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 8
Result
[[3.05990791 -2.1550777 3.43415427 6.85317087 -6.34844446 -4.17641735 -15.8478708 17.6247807 -2.37196636 4.95068121]]
total time trial 8: 52.993101596832275
2018-11-27 15:10:35.616270: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:10:35.616297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:10:35.616306: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:10:35.616316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:10:35.616323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:10:35.616332: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:10:35.616347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:10:35.616366: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:10:35.616379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:10:35.616392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:10:35.616401: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:10:35.616413: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:10:35.616423: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:10:35.616432: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:10:35.616441: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:10:35.616447: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:10:35.616456: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:10:35.616462: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:10:35.616470: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:10:35.616476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:10:35.616520: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:10:35.616536: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:10:35.616545: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:10:35.616554: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:10:35.616563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:10:35.616572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:10:35.616581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:10:35.616589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:10:35.616599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:10:35.616608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:10:35.616617: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:10:35.616625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:10:35.616634: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:10:35.616642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:10:35.616651: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:10:35.616660: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:10:35.616670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:10:35.616741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:10:35.616763: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:10:35.616780: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:10:35.616794: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:10:35.616809: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:10:35.616826: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:10:35.616841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:10:35.616861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:10:35.616875: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:10:35.616898: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:10:35.616912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:10:35.616933: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:10:35.616949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:10:35.616963: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:10:35.616984: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:10:35.616993: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:10:35.617001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:10:35.617009: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:10:35.617031: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:10:35.617039: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:10:35.617048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:10:35.617056: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:10:35.617062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:10:35.617068: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:10:35.617081: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b6fa0 :: reshape/Reshape/shape [Const]
2018-11-27 15:10:35.617089: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7018 :: conv1/Const [Const]
2018-11-27 15:10:35.617096: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7090 :: conv1/pad_const [Const]
2018-11-27 15:10:35.617103: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7108 :: fc1/Reshape/shape [Const]
2018-11-27 15:10:35.617111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7180 :: squash/Const [Const]
2018-11-27 15:10:35.617117: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b71f8 :: fc2/Const [Const]
2018-11-27 15:10:35.617124: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7270 :: reshape/Reshape [Reshape]
2018-11-27 15:10:35.617132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7328 :: conv1/Conv2D [Conv2D]
2018-11-27 15:10:35.617139: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b73e0 :: conv1/Square [Square]
2018-11-27 15:10:35.617146: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7478 :: conv1/Pad [Pad]
2018-11-27 15:10:35.617153: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7530 :: fc1/Reshape [Reshape]
2018-11-27 15:10:35.617160: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b75e8 :: fc1/MatMul [MatMul]
2018-11-27 15:10:35.617167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b76a0 :: fc1/Square [Square]
2018-11-27 15:10:35.617174: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x67b7738 :: fc2/MatMul [MatMul]
2018-11-27 15:10:35.617239: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:10:35.617285: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 9 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:10:35.617317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:10:35.617351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:10:35.617362: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 9, datatype: 1
2018-11-27 15:10:35.618767: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:10:35.618787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:10:36z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:10:36.817805: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 9
2018-11-27 15:10:36.817901: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:10:36.817935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 9
2018-11-27 15:10:36.817957: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_9
2018-11-27 15:10:36.818156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:10:36.818324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:10:36.818385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:10:36.818444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:10:36.818552: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:10:36.818660: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:10:36.818712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:10:36.818734: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:10:36.818754: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:10:36.818759: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:10:36.818771: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:10:36.818802: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:10:36.818810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:10:36.818817: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:10:36.818825: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:10:36.818851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:10:36.818864: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:10:36.818871: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:10:36.818968: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:10:36.819002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:10:36.819047: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:10:36.819081: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:10:36.819104: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:10:36.819113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:10:36.819120: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:10:36.819175: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:10:36.819204: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:10:36.819217: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:10:36.819230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:10:36.819262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:10:36.819881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:10:36.819930: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:10:36.819966: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:10:36.820012: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:10:36.820141: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 9
2018-11-27 15:10:36.820162: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 9
[INFO] 2018-11-27T23:10:36z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:10:36.843231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 9
[INFO] 2018-11-27T23:10:36z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:10:36.844157: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 9
2018-11-27 15:10:36.844171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 9
[INFO] 2018-11-27T23:10:36z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:10:36z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:10:36z src/he_backend.cpp 319	[ Parameter_180 ]
[INFO] 2018-11-27T23:10:36z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:10:36z src/he_backend.cpp 319	[ Constant_197 ]
[INFO] 2018-11-27T23:10:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:10:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:37z src/he_backend.cpp 395	Constant_197 took 185ms
[INFO] 2018-11-27T23:10:37z src/he_backend.cpp 319	[ Constant_194 ]
[INFO] 2018-11-27T23:10:37z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:10:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 395	Constant_194 took 8789ms
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 319	[ Constant_190 ]
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 395	Constant_190 took 5ms
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 319	[ Constant_183 ]
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 395	Constant_183 took 37ms
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 319	[ Reshape_182 ]
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 395	Reshape_182 took 0ms
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 319	[ Reshape_185 ]
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 395	Reshape_185 took 0ms
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 319	[ Reshape_184 ]
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 395	Reshape_184 took 0ms
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 319	[ Convolution_186 ]
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:10:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:49z src/he_backend.cpp 395	Convolution_186 took 3936ms
[INFO] 2018-11-27T23:10:49z src/he_backend.cpp 319	[ Reshape_187 ]
[INFO] 2018-11-27T23:10:49z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:10:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:49z src/he_backend.cpp 395	Reshape_187 took 0ms
[INFO] 2018-11-27T23:10:49z src/he_backend.cpp 319	[ Multiply_188 ]
[INFO] 2018-11-27T23:10:49z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:10:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 395	Multiply_188 took 333ms
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 319	[ Pad_191 ]
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 395	Pad_191 took 0ms
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 319	[ Reshape_193 ]
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 395	Reshape_193 took 0ms
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 319	[ Dot_195 ]
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:10:50z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 395	Dot_195 took 37660ms
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 319	[ Multiply_196 ]
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 395	Multiply_196 took 89ms
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 319	[ Dot_198 ]
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:27z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:11:28z src/he_backend.cpp 395	Dot_198 took 573ms
[INFO] 2018-11-27T23:11:28z src/he_backend.cpp 319	[ Result_199 ]
[INFO] 2018-11-27T23:11:28z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:11:28z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:11:28z src/he_backend.cpp 395	Result_199 took 1ms
2018-11-27 15:11:28.485342: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 9
2018-11-27 15:11:28.589003: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 9
Result
[[-2.10432 -2.4181273 5.51753235 7.86951208 -4.91456556 -3.27262759 -14.4455061 16.3814335 0.0548385233 9.90256]]
total time trial 9: 52.97975993156433
2018-11-27 15:11:28.598485: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:11:28.598511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:11:28.598521: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:11:28.598530: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:11:28.598537: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:11:28.598546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:11:28.598559: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:11:28.598573: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:11:28.598588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:11:28.598601: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:11:28.598611: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:11:28.598622: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:11:28.598631: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:11:28.598640: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:11:28.598649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:11:28.598655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:11:28.598663: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:11:28.598669: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:11:28.598676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:11:28.598682: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:11:28.598728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:11:28.598744: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:11:28.598753: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:11:28.598762: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:11:28.598771: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:11:28.598780: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:11:28.598789: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:11:28.598797: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:11:28.598807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:11:28.598815: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:11:28.598824: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:11:28.598833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:11:28.598842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:11:28.598850: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:11:28.598859: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:11:28.598868: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:11:28.598878: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:11:28.598952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:11:28.598975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:11:28.598992: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:11:28.599006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:11:28.599021: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:11:28.599038: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:11:28.599053: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:11:28.599073: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:11:28.599087: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:11:28.599110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:11:28.599125: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:11:28.599145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:11:28.599162: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:11:28.599176: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:11:28.599197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:11:28.599205: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:11:28.599214: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:11:28.599222: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:11:28.599244: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:11:28.599252: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:11:28.599260: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:11:28.599268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:11:28.599274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:11:28.599280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:11:28.599293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2530 :: reshape/Reshape/shape [Const]
2018-11-27 15:11:28.599301: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b25a8 :: conv1/Const [Const]
2018-11-27 15:11:28.599308: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2620 :: conv1/pad_const [Const]
2018-11-27 15:11:28.599315: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2698 :: fc1/Reshape/shape [Const]
2018-11-27 15:11:28.599322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2710 :: squash/Const [Const]
2018-11-27 15:11:28.599329: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2788 :: fc2/Const [Const]
2018-11-27 15:11:28.599336: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2800 :: reshape/Reshape [Reshape]
2018-11-27 15:11:28.599344: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b28b8 :: conv1/Conv2D [Conv2D]
2018-11-27 15:11:28.599351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2970 :: conv1/Square [Square]
2018-11-27 15:11:28.599357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2a08 :: conv1/Pad [Pad]
2018-11-27 15:11:28.599364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2ac0 :: fc1/Reshape [Reshape]
2018-11-27 15:11:28.599371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2b78 :: fc1/MatMul [MatMul]
2018-11-27 15:11:28.599378: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2c30 :: fc1/Square [Square]
2018-11-27 15:11:28.599385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x67b2cc8 :: fc2/MatMul [MatMul]
2018-11-27 15:11:28.599450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:11:28.599496: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 10 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:11:28.599531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:11:28.599566: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:11:28.599577: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 10, datatype: 1
2018-11-27 15:11:28.601145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:11:28.601168: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:11:29z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:11:29.768776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 10
2018-11-27 15:11:29.768813: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:11:29.768822: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 10
2018-11-27 15:11:29.768827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_10
2018-11-27 15:11:29.768894: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:11:29.768971: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:11:29.768993: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:11:29.769014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:11:29.769050: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:11:29.769097: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:11:29.769113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:11:29.769121: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:11:29.769126: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:11:29.769132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:11:29.769143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:11:29.769173: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:11:29.769180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:11:29.769187: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:11:29.769196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:11:29.769221: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:11:29.769234: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:11:29.769241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:11:29.769333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:11:29.769365: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:11:29.769405: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:11:29.769439: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:11:29.769461: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:11:29.769470: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:11:29.769477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:11:29.769527: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:11:29.769556: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:11:29.769569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:11:29.769582: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:11:29.769615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:11:29.770266: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:11:29.770326: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:11:29.770362: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:11:29.770408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:11:29.770528: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 10
2018-11-27 15:11:29.770547: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 10
[INFO] 2018-11-27T23:11:29z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:11:29.792549: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 10
[INFO] 2018-11-27T23:11:29z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:11:29.792897: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 10
2018-11-27 15:11:29.792914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 10
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 319	[ Parameter_200 ]
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 319	[ Constant_217 ]
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 395	Constant_217 took 151ms
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 319	[ Constant_214 ]
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:11:29z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 395	Constant_214 took 8863ms
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 319	[ Constant_210 ]
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 395	Constant_210 took 5ms
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 319	[ Constant_203 ]
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 395	Constant_203 took 41ms
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 319	[ Reshape_202 ]
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 395	Reshape_202 took 0ms
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 319	[ Reshape_205 ]
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 395	Reshape_205 took 0ms
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 319	[ Reshape_204 ]
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 395	Reshape_204 took 0ms
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 319	[ Convolution_206 ]
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 442	Inputs: Plain, Cipher
[INFO] 2018-11-27T23:11:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 395	Convolution_206 took 4169ms
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 319	[ Reshape_207 ]
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 395	Reshape_207 took 0ms
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 319	[ Multiply_208 ]
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 395	Multiply_208 took 309ms
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 319	[ Pad_211 ]
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 395	Pad_211 took 0ms
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 319	[ Reshape_213 ]
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 395	Reshape_213 took 0ms
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 319	[ Dot_215 ]
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:11:43z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 395	Dot_215 took 37953ms
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 319	[ Multiply_216 ]
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 395	Multiply_216 took 59ms
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 319	[ Dot_218 ]
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 395	Dot_218 took 517ms
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 319	[ Result_219 ]
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T23:12:21z src/he_backend.cpp 395	Result_219 took 1ms
2018-11-27 15:12:21.895892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 10
2018-11-27 15:12:22.002476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 10
Result
[[-6.07756329 -5.31903172 9.48907852 6.39985466 -0.938783526 -3.78954959 -14.7751255 16.9160023 5.89278078 10.7937031]]
total time trial 10: 53.4111111164093
/nfs/site/home/fboemer/repos/he-transformer/experiments/CryptoNets
(he3) ➜  CryptoNets git:(fboemer/cryptonets-timings) ✗
(he3) ➜  CryptoNets git:(fboemer/cryptonets-timings) ✗ ./run_python_timing_13.sh
TensorFlow version installed: 1.12.0 (v1.12.0-0-ga6d8ffae09)
nGraph bridge built with: 1.12.0 (v1.12.0-0-ga6d8ffae09)
Extracting /tmp/tensorflow/mnist/input_data/train-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/train-labels-idx1-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-labels-idx1-ubyte.gz
2018-11-27 09:35:27.012361: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2018-11-27 09:35:27.047172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:35:27.047213: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:35:27.047223: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:35:27.047231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:35:27.047239: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:35:27.047250: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:35:27.047261: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:35:27.047272: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:35:27.047281: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:35:27.047292: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:35:27.047301: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:35:27.047311: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:35:27.047320: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:35:27.047330: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:35:27.047337: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:35:27.047343: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:35:27.047350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:35:27.047356: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:35:27.047364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:35:27.047370: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:35:27.047415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:35:27.047435: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:35:27.047444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:35:27.047453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:35:27.047462: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:35:27.047471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:35:27.047480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:35:27.047488: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:35:27.047498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:35:27.047507: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:35:27.047516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:35:27.047525: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:35:27.047534: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:35:27.047543: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:35:27.047552: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:35:27.047561: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:35:27.047571: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:35:27.047650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:35:27.047674: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:35:27.047691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:35:27.047705: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:35:27.047720: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:35:27.047737: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:35:27.047752: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:35:27.047772: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:35:27.047787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:35:27.047809: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:35:27.047824: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:35:27.047845: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:35:27.047861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:35:27.047875: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:35:27.047896: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:35:27.047905: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:35:27.047914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:35:27.047922: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:35:27.047944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:35:27.047952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:35:27.047961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:35:27.047969: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:35:27.047975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:35:27.047981: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:35:27.047998: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7230 :: reshape/Reshape/shape [Const]
2018-11-27 09:35:27.048006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f72a8 :: conv1/Const [Const]
2018-11-27 09:35:27.048014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7320 :: conv1/pad_const [Const]
2018-11-27 09:35:27.048021: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7398 :: fc1/Reshape/shape [Const]
2018-11-27 09:35:27.048028: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7410 :: squash/Const [Const]
2018-11-27 09:35:27.048035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7488 :: fc2/Const [Const]
2018-11-27 09:35:27.048043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7500 :: reshape/Reshape [Reshape]
2018-11-27 09:35:27.048050: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f75b8 :: conv1/Conv2D [Conv2D]
2018-11-27 09:35:27.048057: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7670 :: conv1/Square [Square]
2018-11-27 09:35:27.048064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7708 :: conv1/Pad [Pad]
2018-11-27 09:35:27.048071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f77c0 :: fc1/Reshape [Reshape]
2018-11-27 09:35:27.048078: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7878 :: fc1/MatMul [MatMul]
2018-11-27 09:35:27.048086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f7930 :: fc1/Square [Square]
2018-11-27 09:35:27.048093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x59f79c8 :: fc2/MatMul [MatMul]
2018-11-27 09:35:27.048156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:35:27.048206: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 0 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:35:27.048240: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:35:27.048278: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:35:27.048289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 0, datatype: 1
2018-11-27 09:35:27.050001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:35:27.050021: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:35:27z src/seal/ckks/he_seal_ckks_backend.cpp 66	Using SEAL CKKS config with 7 30-bit coefficients
[INFO] 2018-11-27T17:35:28z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:35:28.252143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 0
2018-11-27 09:35:28.252240: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:35:28.252273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 0
2018-11-27 09:35:28.252299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_0
2018-11-27 09:35:28.252547: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:35:28.252804: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:35:28.252873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:35:28.252934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:35:28.253004: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:35:28.253052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:35:28.253071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:35:28.253079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:35:28.253086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:35:28.253093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:35:28.253108: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:35:28.253139: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:35:28.253147: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:35:28.253153: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:35:28.253162: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:35:28.253193: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:35:28.253205: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:35:28.253212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:35:28.253333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:35:28.253368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:35:28.253422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:35:28.253458: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:35:28.253480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:35:28.253490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:35:28.253496: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:35:28.253553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:35:28.253584: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:35:28.253599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:35:28.253614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:35:28.253651: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:35:28.254460: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:35:28.254514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:35:28.254553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:35:28.254594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:35:28.254719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 0
2018-11-27 09:35:28.254748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 0
[INFO] 2018-11-27T17:35:28z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:35:28.565205: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 0
[INFO] 2018-11-27T17:35:28z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:35:28.592379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 0
2018-11-27 09:35:28.592402: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 0
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 319	[ Parameter_0 ]
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 319	[ Constant_17 ]
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 395	Constant_17 took 35ms
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 319	[ Constant_14 ]
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:35:28z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 395	Constant_14 took 2418ms
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 319	[ Constant_10 ]
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 395	Constant_10 took 27ms
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 319	[ Constant_3 ]
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 395	Constant_3 took 28ms
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 319	[ Reshape_2 ]
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 395	Reshape_2 took 0ms
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 319	[ Reshape_5 ]
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 395	Reshape_5 took 0ms
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 319	[ Reshape_4 ]
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 395	Reshape_4 took 0ms
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 319	[ Convolution_6 ]
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:35:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 395	Convolution_6 took 3864ms
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 319	[ Reshape_7 ]
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 395	Reshape_7 took 0ms
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 319	[ Multiply_8 ]
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 395	Multiply_8 took 383ms
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 319	[ Pad_11 ]
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 395	Pad_11 took 6ms
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 319	[ Reshape_13 ]
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 395	Reshape_13 took 0ms
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 319	[ Dot_15 ]
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:35z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 395	Dot_15 took 18498ms
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 319	[ Multiply_16 ]
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 395	Multiply_16 took 91ms
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 319	[ Dot_18 ]
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 395	Dot_18 took 379ms
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 319	[ Result_19 ]
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:54z src/he_backend.cpp 395	Result_19 took 3ms
2018-11-27 09:35:55.009634: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 0
2018-11-27 09:35:55.337593: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 0
Result
[[0.832217932 -2.8832612 4.91213655 6.7890234 -5.02713537 -4.10676813 -15.6052074 17.4635239 -0.344742119 6.29705191]]
total time warmup: 28.30379819869995
2018-11-27 09:35:55.349598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:35:55.349644: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:35:55.349662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:35:55.349678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:35:55.349698: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:35:55.349715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:35:55.349752: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:35:55.349775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:35:55.349801: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:35:55.349827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:35:55.349848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:35:55.349873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:35:55.349895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:35:55.349914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:35:55.349932: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:35:55.349947: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:35:55.349962: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:35:55.349975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:35:55.349989: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:35:55.350002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:35:55.350080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:35:55.350111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:35:55.350129: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:35:55.350146: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:35:55.350165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:35:55.350182: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:35:55.350199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:35:55.350216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:35:55.350233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:35:55.350250: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:35:55.350267: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:35:55.350284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:35:55.350301: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:35:55.350317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:35:55.350334: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:35:55.350351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:35:55.350369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:35:55.350479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:35:55.350516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:35:55.350544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:35:55.350569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:35:55.350593: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:35:55.350621: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:35:55.350646: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:35:55.350678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:35:55.350702: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:35:55.350736: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:35:55.350760: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:35:55.350791: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:35:55.350818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:35:55.350842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:35:55.350874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:35:55.350890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:35:55.350907: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:35:55.350923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:35:55.350956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:35:55.350972: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:35:55.350989: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:35:55.351005: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:35:55.351019: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:35:55.351035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:35:55.351064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a580 :: reshape/Reshape/shape [Const]
2018-11-27 09:35:55.351080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a5f8 :: conv1/Const [Const]
2018-11-27 09:35:55.351095: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a670 :: conv1/pad_const [Const]
2018-11-27 09:35:55.351110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a6e8 :: fc1/Reshape/shape [Const]
2018-11-27 09:35:55.351125: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a760 :: squash/Const [Const]
2018-11-27 09:35:55.351140: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a7d8 :: fc2/Const [Const]
2018-11-27 09:35:55.351154: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a850 :: reshape/Reshape [Reshape]
2018-11-27 09:35:55.351169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a908 :: conv1/Conv2D [Conv2D]
2018-11-27 09:35:55.351184: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837a9c0 :: conv1/Square [Square]
2018-11-27 09:35:55.351199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837aa58 :: conv1/Pad [Pad]
2018-11-27 09:35:55.351214: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837ab10 :: fc1/Reshape [Reshape]
2018-11-27 09:35:55.351228: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837abc8 :: fc1/MatMul [MatMul]
2018-11-27 09:35:55.351243: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837ac80 :: fc1/Square [Square]
2018-11-27 09:35:55.351258: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x837ad18 :: fc2/MatMul [MatMul]
2018-11-27 09:35:55.351345: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:35:55.351413: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 1 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:35:55.351455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:35:55.351507: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:35:55.351520: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 1, datatype: 1
2018-11-27 09:35:55.352465: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:35:55.352487: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:35:56z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:35:56.564569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 1
2018-11-27 09:35:56.564682: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:35:56.564715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 1
2018-11-27 09:35:56.564739: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_1
2018-11-27 09:35:56.564941: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:35:56.565133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:35:56.565161: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:35:56.565188: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:35:56.565229: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:35:56.565282: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:35:56.565303: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:35:56.565310: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:35:56.565316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:35:56.565322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:35:56.565334: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:35:56.565369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:35:56.565376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:35:56.565383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:35:56.565392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:35:56.565418: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:35:56.565432: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:35:56.565439: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:35:56.565539: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:35:56.565573: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:35:56.565620: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:35:56.565654: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:35:56.565680: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:35:56.565689: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:35:56.565696: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:35:56.565751: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:35:56.565781: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:35:56.565794: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:35:56.565807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:35:56.565844: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:35:56.566665: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:35:56.566713: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:35:56.566750: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:35:56.566790: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:35:56.566914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 1
2018-11-27 09:35:56.566933: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 1
[INFO] 2018-11-27T17:35:56z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:35:56.696125: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 1
[INFO] 2018-11-27T17:35:56z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:35:56.696719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 1
2018-11-27 09:35:56.696732: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 1
[INFO] 2018-11-27T17:35:56z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:35:56z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 319	[ Parameter_20 ]
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 319	[ Constant_37 ]
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 395	Constant_37 took 13ms
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 319	[ Constant_34 ]
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:35:57z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 395	Constant_34 took 2121ms
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 319	[ Constant_30 ]
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 395	Constant_30 took 0ms
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 319	[ Constant_23 ]
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 395	Constant_23 took 4ms
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 319	[ Reshape_22 ]
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 395	Reshape_22 took 0ms
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 319	[ Reshape_25 ]
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 395	Reshape_25 took 0ms
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 319	[ Reshape_24 ]
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 395	Reshape_24 took 0ms
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 319	[ Convolution_26 ]
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:35:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:03z src/he_backend.cpp 395	Convolution_26 took 4405ms
[INFO] 2018-11-27T17:36:03z src/he_backend.cpp 319	[ Reshape_27 ]
[INFO] 2018-11-27T17:36:03z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:03z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:03z src/he_backend.cpp 395	Reshape_27 took 0ms
[INFO] 2018-11-27T17:36:03z src/he_backend.cpp 319	[ Multiply_28 ]
[INFO] 2018-11-27T17:36:03z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:36:03z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 395	Multiply_28 took 366ms
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 319	[ Pad_31 ]
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 395	Pad_31 took 5ms
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 319	[ Reshape_33 ]
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 395	Reshape_33 took 0ms
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 319	[ Dot_35 ]
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:04z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 395	Dot_35 took 13108ms
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 319	[ Multiply_36 ]
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 395	Multiply_36 took 512ms
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 319	[ Dot_38 ]
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 395	Dot_38 took 261ms
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 319	[ Result_39 ]
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:17z src/he_backend.cpp 395	Result_39 took 2ms
2018-11-27 09:36:17.927341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 1
2018-11-27 09:36:18.246670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 1
Result
[[-0.22594513 -3.09790301 5.47805214 6.59203959 -4.29298782 -4.01507902 -15.2069969 17.0740776 0.519328177 7.06957102]]
total time trial 1: 22.90507459640503
2018-11-27 09:36:18.256790: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:36:18.256816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:36:18.256827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:36:18.256837: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:36:18.256846: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:36:18.256856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:36:18.256869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:36:18.256883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:36:18.256894: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:36:18.256907: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:36:18.256917: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:36:18.256927: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:36:18.256936: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:36:18.256945: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:36:18.256954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:36:18.256961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:36:18.256968: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:36:18.256975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:36:18.256982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:36:18.256988: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:36:18.257036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:36:18.257054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:36:18.257063: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:36:18.257071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:36:18.257081: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:36:18.257089: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:36:18.257098: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:36:18.257106: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:36:18.257116: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:36:18.257124: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:36:18.257133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:36:18.257142: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:36:18.257150: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:36:18.257159: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:36:18.257167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:36:18.257177: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:36:18.257186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:36:18.257263: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:36:18.257285: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:36:18.257303: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:36:18.257317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:36:18.257332: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:36:18.257349: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:36:18.257364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:36:18.257384: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:36:18.257398: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:36:18.257420: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:36:18.257435: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:36:18.257455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:36:18.257471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:36:18.257485: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:36:18.257507: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:36:18.257515: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:36:18.257524: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:36:18.257532: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:36:18.257554: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:36:18.257562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:36:18.257571: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:36:18.257579: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:36:18.257585: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:36:18.257590: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:36:18.257607: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a540 :: reshape/Reshape/shape [Const]
2018-11-27 09:36:18.257615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a5b8 :: conv1/Const [Const]
2018-11-27 09:36:18.257622: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a630 :: conv1/pad_const [Const]
2018-11-27 09:36:18.257630: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a6a8 :: fc1/Reshape/shape [Const]
2018-11-27 09:36:18.257637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a720 :: squash/Const [Const]
2018-11-27 09:36:18.257644: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a798 :: fc2/Const [Const]
2018-11-27 09:36:18.257651: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a810 :: reshape/Reshape [Reshape]
2018-11-27 09:36:18.257658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a8c8 :: conv1/Conv2D [Conv2D]
2018-11-27 09:36:18.257665: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838a980 :: conv1/Square [Square]
2018-11-27 09:36:18.257672: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838aa18 :: conv1/Pad [Pad]
2018-11-27 09:36:18.257679: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838aad0 :: fc1/Reshape [Reshape]
2018-11-27 09:36:18.257687: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838ab88 :: fc1/MatMul [MatMul]
2018-11-27 09:36:18.257694: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838ac40 :: fc1/Square [Square]
2018-11-27 09:36:18.257701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x838acd8 :: fc2/MatMul [MatMul]
2018-11-27 09:36:18.257767: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:36:18.257815: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 2 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:36:18.257848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:36:18.257881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:36:18.257892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 2, datatype: 1
2018-11-27 09:36:18.259293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:36:18.259314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:36:19z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:36:19.407180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 2
2018-11-27 09:36:19.407313: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:36:19.407346: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 2
2018-11-27 09:36:19.407368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_2
2018-11-27 09:36:19.407556: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:36:19.407639: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:36:19.407665: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:36:19.407692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:36:19.407736: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:36:19.407788: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:36:19.407807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:36:19.407814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:36:19.407819: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:36:19.407825: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:36:19.407837: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:36:19.407867: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:36:19.407874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:36:19.407881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:36:19.407889: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:36:19.407916: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:36:19.407930: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:36:19.407937: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:36:19.408034: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:36:19.408067: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:36:19.408113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:36:19.408148: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:36:19.408171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:36:19.408180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:36:19.408187: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:36:19.408242: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:36:19.408271: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:36:19.408284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:36:19.408296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:36:19.408328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:36:19.408975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:36:19.409026: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:36:19.409062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:36:19.409106: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:36:19.409234: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 2
2018-11-27 09:36:19.409254: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 2
[INFO] 2018-11-27T17:36:19z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:36:19.431263: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 2
[INFO] 2018-11-27T17:36:19z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:36:19.432002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 2
2018-11-27 09:36:19.432034: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 2
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 319	[ Parameter_40 ]
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 319	[ Constant_57 ]
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 395	Constant_57 took 12ms
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 319	[ Constant_54 ]
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:19z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 395	Constant_54 took 2235ms
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 319	[ Constant_50 ]
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 395	Constant_50 took 0ms
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 319	[ Constant_43 ]
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 395	Constant_43 took 5ms
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 319	[ Reshape_42 ]
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 395	Reshape_42 took 0ms
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 319	[ Reshape_45 ]
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 395	Reshape_45 took 0ms
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 319	[ Reshape_44 ]
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 395	Reshape_44 took 0ms
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 319	[ Convolution_46 ]
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:25z src/he_backend.cpp 395	Convolution_46 took 3926ms
[INFO] 2018-11-27T17:36:25z src/he_backend.cpp 319	[ Reshape_47 ]
[INFO] 2018-11-27T17:36:25z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:25z src/he_backend.cpp 395	Reshape_47 took 0ms
[INFO] 2018-11-27T17:36:25z src/he_backend.cpp 319	[ Multiply_48 ]
[INFO] 2018-11-27T17:36:25z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:36:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 395	Multiply_48 took 313ms
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 319	[ Pad_51 ]
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 395	Pad_51 took 5ms
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 319	[ Reshape_53 ]
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 395	Reshape_53 took 0ms
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 319	[ Dot_55 ]
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:26z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 395	Dot_55 took 10856ms
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 319	[ Multiply_56 ]
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 395	Multiply_56 took 48ms
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 319	[ Dot_58 ]
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:36z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:36:37z src/he_backend.cpp 395	Dot_58 took 257ms
[INFO] 2018-11-27T17:36:37z src/he_backend.cpp 319	[ Result_59 ]
[INFO] 2018-11-27T17:36:37z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:37z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:37z src/he_backend.cpp 395	Result_59 took 1ms
2018-11-27 09:36:37.244921: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 2
2018-11-27 09:36:37.573838: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 2
Result
[[-2.90256739 -4.04394293 7.20058918 6.67279863 -3.02649665 -3.83547783 -15.0422897 17.0515175 2.73882413 8.93609524]]
total time trial 2: 19.32515597343445
2018-11-27 09:36:37.584891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:36:37.584934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:36:37.584944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:36:37.584969: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:36:37.584992: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:36:37.585001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:36:37.585031: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:36:37.585041: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:36:37.585053: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:36:37.585074: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:36:37.585084: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:36:37.585095: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:36:37.585105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:36:37.585114: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:36:37.585123: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:36:37.585129: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:36:37.585137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:36:37.585143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:36:37.585151: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:36:37.585157: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:36:37.585216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:36:37.585236: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:36:37.585245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:36:37.585254: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:36:37.585263: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:36:37.585272: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:36:37.585281: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:36:37.585290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:36:37.585299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:36:37.585308: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:36:37.585316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:36:37.585325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:36:37.585334: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:36:37.585343: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:36:37.585352: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:36:37.585361: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:36:37.585371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:36:37.585454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:36:37.585479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:36:37.585497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:36:37.585511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:36:37.585527: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:36:37.585544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:36:37.585558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:36:37.585578: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:36:37.585592: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:36:37.585615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:36:37.585630: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:36:37.585651: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:36:37.585667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:36:37.585681: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:36:37.585703: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:36:37.585711: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:36:37.585720: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:36:37.585728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:36:37.585750: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:36:37.585758: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:36:37.585767: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:36:37.585775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:36:37.585781: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:36:37.585787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:36:37.585802: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388610 :: reshape/Reshape/shape [Const]
2018-11-27 09:36:37.585810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388688 :: conv1/Const [Const]
2018-11-27 09:36:37.585817: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388700 :: conv1/pad_const [Const]
2018-11-27 09:36:37.585824: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388778 :: fc1/Reshape/shape [Const]
2018-11-27 09:36:37.585831: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x83887f0 :: squash/Const [Const]
2018-11-27 09:36:37.585839: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388868 :: fc2/Const [Const]
2018-11-27 09:36:37.585846: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x83888e0 :: reshape/Reshape [Reshape]
2018-11-27 09:36:37.585853: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388998 :: conv1/Conv2D [Conv2D]
2018-11-27 09:36:37.585861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388a50 :: conv1/Square [Square]
2018-11-27 09:36:37.585868: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388ae8 :: conv1/Pad [Pad]
2018-11-27 09:36:37.585875: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388ba0 :: fc1/Reshape [Reshape]
2018-11-27 09:36:37.585882: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388c58 :: fc1/MatMul [MatMul]
2018-11-27 09:36:37.585890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388d10 :: fc1/Square [Square]
2018-11-27 09:36:37.585897: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x8388da8 :: fc2/MatMul [MatMul]
2018-11-27 09:36:37.585961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:36:37.586014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 3 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:36:37.586048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:36:37.586090: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:36:37.586101: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 3, datatype: 1
2018-11-27 09:36:37.587787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:36:37.587865: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:36:38z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:36:38.749381: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 3
2018-11-27 09:36:38.749468: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:36:38.749495: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 3
2018-11-27 09:36:38.749516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_3
2018-11-27 09:36:38.749664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:36:38.749780: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:36:38.749813: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:36:38.749836: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:36:38.749877: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:36:38.749917: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:36:38.749933: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:36:38.749940: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:36:38.749945: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:36:38.749950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:36:38.749960: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:36:38.749988: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:36:38.749995: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:36:38.750001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:36:38.750009: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:36:38.750033: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:36:38.750045: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:36:38.750051: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:36:38.750140: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:36:38.750170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:36:38.750222: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:36:38.750254: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:36:38.750280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:36:38.750289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:36:38.750296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:36:38.750347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:36:38.750375: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:36:38.750388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:36:38.750401: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:36:38.750433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:36:38.751047: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:36:38.751092: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:36:38.751127: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:36:38.751171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:36:38.751297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 3
2018-11-27 09:36:38.751316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 3
[INFO] 2018-11-27T17:36:38z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:36:38.777936: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 3
[INFO] 2018-11-27T17:36:38z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:36:38.778650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 3
2018-11-27 09:36:38.778662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 3
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 319	[ Parameter_60 ]
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 319	[ Constant_77 ]
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 395	Constant_77 took 10ms
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 319	[ Constant_74 ]
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:38z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 395	Constant_74 took 1119ms
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 319	[ Constant_70 ]
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 395	Constant_70 took 0ms
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 319	[ Constant_63 ]
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 395	Constant_63 took 2ms
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 319	[ Reshape_62 ]
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 395	Reshape_62 took 0ms
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 319	[ Reshape_65 ]
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 395	Reshape_65 took 0ms
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 319	[ Reshape_64 ]
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 395	Reshape_64 took 0ms
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 319	[ Convolution_66 ]
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:43z src/he_backend.cpp 395	Convolution_66 took 3708ms
[INFO] 2018-11-27T17:36:43z src/he_backend.cpp 319	[ Reshape_67 ]
[INFO] 2018-11-27T17:36:43z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:43z src/he_backend.cpp 395	Reshape_67 took 0ms
[INFO] 2018-11-27T17:36:43z src/he_backend.cpp 319	[ Multiply_68 ]
[INFO] 2018-11-27T17:36:43z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:36:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 395	Multiply_68 took 394ms
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 319	[ Pad_71 ]
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 395	Pad_71 took 5ms
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 319	[ Reshape_73 ]
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 395	Reshape_73 took 0ms
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 319	[ Dot_75 ]
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:44z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 395	Dot_75 took 11115ms
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 319	[ Multiply_76 ]
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 395	Multiply_76 took 30ms
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 319	[ Dot_78 ]
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 395	Dot_78 took 262ms
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 319	[ Result_79 ]
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:55z src/he_backend.cpp 395	Result_79 took 2ms
2018-11-27 09:36:55.586777: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 3
2018-11-27 09:36:55.808945: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 3
Result
[[-1.53111708 -3.63882685 6.37977886 6.69596386 -3.72952557 -3.94332027 -15.2529106 17.2019577 1.64044917 7.96304703]]
total time trial 3: 18.231614351272583
2018-11-27 09:36:55.818814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:36:55.818840: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:36:55.818849: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:36:55.818857: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:36:55.818864: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:36:55.818872: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:36:55.818886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:36:55.818898: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:36:55.818926: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:36:55.818939: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:36:55.818949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:36:55.818964: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:36:55.818973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:36:55.818982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:36:55.818991: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:36:55.818997: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:36:55.819004: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:36:55.819010: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:36:55.819018: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:36:55.819024: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:36:55.819071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:36:55.819088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:36:55.819097: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:36:55.819105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:36:55.819114: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:36:55.819123: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:36:55.819131: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:36:55.819139: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:36:55.819148: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:36:55.819157: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:36:55.819165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:36:55.819173: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:36:55.819182: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:36:55.819190: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:36:55.819199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:36:55.819207: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:36:55.819217: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:36:55.819292: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:36:55.819313: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:36:55.819331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:36:55.819344: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:36:55.819359: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:36:55.819376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:36:55.819390: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:36:55.819409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:36:55.819423: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:36:55.819445: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:36:55.819459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:36:55.819479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:36:55.819495: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:36:55.819508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:36:55.819529: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:36:55.819537: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:36:55.819545: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:36:55.819553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:36:55.819575: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:36:55.819583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:36:55.819591: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:36:55.819599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:36:55.819605: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:36:55.819610: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:36:55.819627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837bc10 :: reshape/Reshape/shape [Const]
2018-11-27 09:36:55.819635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837bc88 :: conv1/Const [Const]
2018-11-27 09:36:55.819642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837bd00 :: conv1/pad_const [Const]
2018-11-27 09:36:55.819649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837bd78 :: fc1/Reshape/shape [Const]
2018-11-27 09:36:55.819657: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837bdf0 :: squash/Const [Const]
2018-11-27 09:36:55.819664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837be68 :: fc2/Const [Const]
2018-11-27 09:36:55.819671: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837bee0 :: reshape/Reshape [Reshape]
2018-11-27 09:36:55.819678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837bf98 :: conv1/Conv2D [Conv2D]
2018-11-27 09:36:55.819686: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837c050 :: conv1/Square [Square]
2018-11-27 09:36:55.819692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837c0e8 :: conv1/Pad [Pad]
2018-11-27 09:36:55.819700: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837c1a0 :: fc1/Reshape [Reshape]
2018-11-27 09:36:55.819707: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837c258 :: fc1/MatMul [MatMul]
2018-11-27 09:36:55.819714: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837c310 :: fc1/Square [Square]
2018-11-27 09:36:55.819721: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x837c3a8 :: fc2/MatMul [MatMul]
2018-11-27 09:36:55.819784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:36:55.819831: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 4 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:36:55.819864: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:36:55.819899: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:36:55.819910: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 4, datatype: 1
2018-11-27 09:36:55.821871: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:36:55.821926: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:36:56z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:36:56.957055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 4
2018-11-27 09:36:56.957087: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:36:56.957096: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 4
2018-11-27 09:36:56.957102: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_4
2018-11-27 09:36:56.957166: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:36:56.957243: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:36:56.957265: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:36:56.957287: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:36:56.957330: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:36:56.957377: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:36:56.957395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:36:56.957403: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:36:56.957408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:36:56.957414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:36:56.957425: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:36:56.957455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:36:56.957463: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:36:56.957469: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:36:56.957478: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:36:56.957503: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:36:56.957516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:36:56.957523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:36:56.957618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:36:56.957649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:36:56.957689: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:36:56.957722: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:36:56.957744: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:36:56.957754: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:36:56.957760: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:36:56.957810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:36:56.957838: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:36:56.957851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:36:56.957865: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:36:56.957896: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:36:56.958563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:36:56.958613: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:36:56.958649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:36:56.958693: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:36:56.958816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 4
2018-11-27 09:36:56.958845: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 4
[INFO] 2018-11-27T17:36:56z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:36:56.981719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 4
[INFO] 2018-11-27T17:36:56z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:36:56.982052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 4
2018-11-27 09:36:56.982067: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 4
[INFO] 2018-11-27T17:36:56z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:36:56z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 319	[ Parameter_80 ]
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 319	[ Constant_97 ]
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 395	Constant_97 took 11ms
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 319	[ Constant_94 ]
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:57z src/he_backend.cpp 450	Outputs: Plain
 [INFO] 2018-11-27T17:36:58z src/he_backend.cpp 395	Constant_94 took 1156ms
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 319	[ Constant_90 ]
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 395	Constant_90 took 0ms
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 319	[ Constant_83 ]
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 395	Constant_83 took 1ms
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 319	[ Reshape_82 ]
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 395	Reshape_82 took 0ms
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 319	[ Reshape_85 ]
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 395	Reshape_85 took 0ms
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 319	[ Reshape_84 ]
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 395	Reshape_84 took 0ms
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 319	[ Convolution_86 ]
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:36:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 395	Convolution_86 took 4039ms
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 319	[ Reshape_87 ]
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 395	Reshape_87 took 0ms
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 319	[ Multiply_88 ]
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 395	Multiply_88 took 288ms
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 319	[ Pad_91 ]
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 395	Pad_91 took 5ms
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 319	[ Reshape_93 ]
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 395	Reshape_93 took 0ms
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 319	[ Dot_95 ]
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:02z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 395	Dot_95 took 12001ms
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 319	[ Multiply_96 ]
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 395	Multiply_96 took 34ms
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 319	[ Dot_98 ]
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:14z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:37:15z src/he_backend.cpp 395	Dot_98 took 259ms
[INFO] 2018-11-27T17:37:15z src/he_backend.cpp 319	[ Result_99 ]
[INFO] 2018-11-27T17:37:15z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:15z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:15z src/he_backend.cpp 395	Result_99 took 1ms
2018-11-27 09:37:15.072109: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 4
2018-11-27 09:37:15.258978: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 4
Result
[[0.201195374 -3.03345752 5.26757765 6.68498039 -4.59639692 -4.05601406 -15.3998203 17.2637806 0.186126798 6.75821877]]
total time trial 4: 19.447388410568237
2018-11-27 09:37:15.269477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:37:15.269503: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:37:15.269512: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:37:15.269537: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:37:15.269548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:37:15.269579: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:37:15.269594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:37:15.269604: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:37:15.269616: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:37:15.269632: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:37:15.269640: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:37:15.269651: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:37:15.269658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:37:15.269683: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:37:15.269692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:37:15.269698: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:37:15.269714: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:37:15.269720: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:37:15.269728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:37:15.269734: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:37:15.269782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:37:15.269799: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:37:15.269808: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:37:15.269817: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:37:15.269826: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:37:15.269834: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:37:15.269843: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:37:15.269851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:37:15.269860: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:37:15.269869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:37:15.269878: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:37:15.269886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:37:15.269895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:37:15.269903: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:37:15.269912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:37:15.269921: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:37:15.269931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:37:15.270005: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:37:15.270028: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:37:15.270044: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:37:15.270058: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:37:15.270074: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:37:15.270091: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:37:15.270105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:37:15.270125: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:37:15.270139: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:37:15.270161: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:37:15.270176: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:37:15.270196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:37:15.270212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:37:15.270226: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:37:15.270247: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:37:15.270255: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:37:15.270264: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:37:15.270272: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:37:15.270294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:37:15.270302: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:37:15.270311: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:37:15.270319: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:37:15.270325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:37:15.270331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:37:15.270345: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373810 :: reshape/Reshape/shape [Const]
2018-11-27 09:37:15.270353: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373888 :: conv1/Const [Const]
2018-11-27 09:37:15.270360: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373900 :: conv1/pad_const [Const]
2018-11-27 09:37:15.270378: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373978 :: fc1/Reshape/shape [Const]
2018-11-27 09:37:15.270385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x83739f0 :: squash/Const [Const]
2018-11-27 09:37:15.270392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373a68 :: fc2/Const [Const]
2018-11-27 09:37:15.270399: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373ae0 :: reshape/Reshape [Reshape]
2018-11-27 09:37:15.270406: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373b98 :: conv1/Conv2D [Conv2D]
2018-11-27 09:37:15.270413: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373c50 :: conv1/Square [Square]
2018-11-27 09:37:15.270420: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373ce8 :: conv1/Pad [Pad]
2018-11-27 09:37:15.270426: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373da0 :: fc1/Reshape [Reshape]
2018-11-27 09:37:15.270433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373e58 :: fc1/MatMul [MatMul]
2018-11-27 09:37:15.270440: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373f10 :: fc1/Square [Square]
2018-11-27 09:37:15.270448: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x8373fa8 :: fc2/MatMul [MatMul]
2018-11-27 09:37:15.270511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:37:15.270558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 5 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:37:15.270591: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:37:15.270625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:37:15.270636: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 5, datatype: 1
2018-11-27 09:37:15.272289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:37:15.272317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:37:16z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:37:16.429200: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 5
2018-11-27 09:37:16.429280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:37:16.429304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 5
2018-11-27 09:37:16.429325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_5
2018-11-27 09:37:16.429467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:37:16.429704: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:37:16.429782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:37:16.429837: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:37:16.429929: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:37:16.429976: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:37:16.429994: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:37:16.430001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:37:16.430007: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:37:16.430013: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:37:16.430023: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:37:16.430052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:37:16.430059: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:37:16.430065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:37:16.430074: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:37:16.430100: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:37:16.430111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:37:16.430118: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:37:16.430209: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:37:16.430240: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:37:16.430290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:37:16.430323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:37:16.430348: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:37:16.430357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:37:16.430364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:37:16.430414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:37:16.430443: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:37:16.430456: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:37:16.430470: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:37:16.430502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:37:16.431088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:37:16.431132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:37:16.431167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:37:16.431207: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:37:16.431322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 5
2018-11-27 09:37:16.431341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 5
[INFO] 2018-11-27T17:37:16z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:37:16.453232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 5
[INFO] 2018-11-27T17:37:16z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:37:16.453641: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 5
2018-11-27 09:37:16.453654: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 5
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 319	[ Parameter_100 ]
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 319	[ Constant_117 ]
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 395	Constant_117 took 10ms
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 319	[ Constant_114 ]
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:16z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 395	Constant_114 took 1131ms
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 319	[ Constant_110 ]
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 395	Constant_110 took 0ms
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 319	[ Constant_103 ]
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 395	Constant_103 took 3ms
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 319	[ Reshape_102 ]
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 395	Reshape_102 took 0ms
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 319	[ Reshape_105 ]
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 395	Reshape_105 took 0ms
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 319	[ Reshape_104 ]
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 395	Reshape_104 took 0ms
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 319	[ Convolution_106 ]
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:21z src/he_backend.cpp 395	Convolution_106 took 4000ms
[INFO] 2018-11-27T17:37:21z src/he_backend.cpp 319	[ Reshape_107 ]
[INFO] 2018-11-27T17:37:21z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:21z src/he_backend.cpp 395	Reshape_107 took 0ms
[INFO] 2018-11-27T17:37:21z src/he_backend.cpp 319	[ Multiply_108 ]
[INFO] 2018-11-27T17:37:21z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:37:21z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 395	Multiply_108 took 306ms
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 319	[ Pad_111 ]
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 395	Pad_111 took 4ms
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 319	[ Reshape_113 ]
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 395	Reshape_113 took 0ms
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 319	[ Dot_115 ]
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:22z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 395	Dot_115 took 11269ms
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 319	[ Multiply_116 ]
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 395	Multiply_116 took 36ms
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 319	[ Dot_118 ]
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 395	Dot_118 took 307ms
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 319	[ Result_119 ]
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:33z src/he_backend.cpp 395	Result_119 took 1ms
2018-11-27 09:37:33.678536: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 5
2018-11-27 09:37:33.941818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 5
Result
[[-2.40648127 -3.95083809 6.94732952 6.69488907 -3.28127885 -3.88981676 -15.1786671 17.1708298 2.38494778 8.5676527]]
total time trial 5: 18.67997694015503
2018-11-27 09:37:33.952110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:37:33.952145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:37:33.952171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:37:33.952180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:37:33.952190: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:37:33.952199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:37:33.952214: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:37:33.952224: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:37:33.952236: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:37:33.952250: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:37:33.952260: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:37:33.952277: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:37:33.952286: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:37:33.952295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:37:33.952304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:37:33.952311: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:37:33.952319: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:37:33.952325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:37:33.952332: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:37:33.952339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:37:33.952404: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:37:33.952433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:37:33.952442: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:37:33.952450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:37:33.952461: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:37:33.952470: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:37:33.952478: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:37:33.952487: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:37:33.952496: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:37:33.952505: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:37:33.952514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:37:33.952522: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:37:33.952531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:37:33.952540: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:37:33.952549: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:37:33.952557: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:37:33.952567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:37:33.952647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:37:33.952671: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:37:33.952688: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:37:33.952703: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:37:33.952717: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:37:33.952735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:37:33.952749: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:37:33.952769: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:37:33.952784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:37:33.952806: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:37:33.952820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:37:33.952841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:37:33.952858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:37:33.952872: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:37:33.952893: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:37:33.952901: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:37:33.952910: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:37:33.952918: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:37:33.952941: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:37:33.952949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:37:33.952958: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:37:33.952965: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:37:33.952972: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:37:33.952977: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:37:33.952991: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bab0 :: reshape/Reshape/shape [Const]
2018-11-27 09:37:33.952999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bb28 :: conv1/Const [Const]
2018-11-27 09:37:33.953007: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bba0 :: conv1/pad_const [Const]
2018-11-27 09:37:33.953014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bc18 :: fc1/Reshape/shape [Const]
2018-11-27 09:37:33.953021: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bc90 :: squash/Const [Const]
2018-11-27 09:37:33.953028: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bd08 :: fc2/Const [Const]
2018-11-27 09:37:33.953035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bd80 :: reshape/Reshape [Reshape]
2018-11-27 09:37:33.953043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837be38 :: conv1/Conv2D [Conv2D]
2018-11-27 09:37:33.953050: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bef0 :: conv1/Square [Square]
2018-11-27 09:37:33.953057: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837bf88 :: conv1/Pad [Pad]
2018-11-27 09:37:33.953065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837c040 :: fc1/Reshape [Reshape]
2018-11-27 09:37:33.953072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837c0f8 :: fc1/MatMul [MatMul]
2018-11-27 09:37:33.953079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837c1b0 :: fc1/Square [Square]
2018-11-27 09:37:33.953086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x837c248 :: fc2/MatMul [MatMul]
2018-11-27 09:37:33.953152: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:37:33.953203: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 6 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:37:33.953238: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:37:33.953276: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:37:33.953288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 6, datatype: 1
2018-11-27 09:37:33.954588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:37:33.954609: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:37:35z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:37:35.142273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 6
2018-11-27 09:37:35.142348: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:37:35.142373: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 6
2018-11-27 09:37:35.142403: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_6
2018-11-27 09:37:35.142548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:37:35.142631: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:37:35.142652: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:37:35.142674: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:37:35.142712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:37:35.142760: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:37:35.142776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:37:35.142784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:37:35.142789: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:37:35.142795: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:37:35.142805: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:37:35.142835: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:37:35.142842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:37:35.142848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:37:35.142857: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:37:35.142883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:37:35.142894: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:37:35.142901: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:37:35.142995: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:37:35.143027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:37:35.143071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:37:35.143103: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:37:35.143125: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:37:35.143134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:37:35.143141: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:37:35.143191: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:37:35.143218: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:37:35.143231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:37:35.143244: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:37:35.143274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:37:35.143900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:37:35.143946: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:37:35.143982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:37:35.144027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:37:35.144150: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 6
2018-11-27 09:37:35.144168: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 6
[INFO] 2018-11-27T17:37:35z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:37:35.172306: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 6
[INFO] 2018-11-27T17:37:35z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:37:35.172661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 6
2018-11-27 09:37:35.172674: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 6
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 319	[ Parameter_120 ]
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 319	[ Constant_137 ]
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 395	Constant_137 took 10ms
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 319	[ Constant_134 ]
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:35z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 395	Constant_134 took 1184ms
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 319	[ Constant_130 ]
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 395	Constant_130 took 0ms
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 319	[ Constant_123 ]
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 395	Constant_123 took 1ms
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 319	[ Reshape_122 ]
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 395	Reshape_122 took 0ms
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 319	[ Reshape_125 ]
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 395	Reshape_125 took 0ms
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 319	[ Reshape_124 ]
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 395	Reshape_124 took 0ms
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 319	[ Convolution_126 ]
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:40z src/he_backend.cpp 395	Convolution_126 took 3688ms
[INFO] 2018-11-27T17:37:40z src/he_backend.cpp 319	[ Reshape_127 ]
[INFO] 2018-11-27T17:37:40z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:40z src/he_backend.cpp 395	Reshape_127 took 0ms
[INFO] 2018-11-27T17:37:40z src/he_backend.cpp 319	[ Multiply_128 ]
[INFO] 2018-11-27T17:37:40z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:37:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 395	Multiply_128 took 792ms
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 319	[ Pad_131 ]
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 395	Pad_131 took 4ms
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 319	[ Reshape_133 ]
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 395	Reshape_133 took 0ms
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 319	[ Dot_135 ]
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:41z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 395	Dot_135 took 11293ms
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 319	[ Multiply_136 ]
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 395	Multiply_136 took 39ms
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 319	[ Dot_138 ]
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 395	Dot_138 took 260ms
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 319	[ Result_139 ]
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:52z src/he_backend.cpp 395	Result_139 took 2ms
2018-11-27 09:37:52.650999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 6
2018-11-27 09:37:52.853282: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 6
Result
[[-2.41848564 -3.94832587 6.9530549 6.64269876 -3.21720195 -3.8964684 -15.1289358 17.1166019 2.41610241 8.56290531]]
total time trial 6: 18.90846824645996
2018-11-27 09:37:52.863503: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:37:52.863574: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:37:52.863608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:37:52.863618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:37:52.863626: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:37:52.863635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:37:52.863649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:37:52.863659: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:37:52.863670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:37:52.863681: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:37:52.863691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:37:52.863702: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:37:52.863710: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:37:52.863719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:37:52.863728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:37:52.863734: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:37:52.863742: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:37:52.863748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:37:52.863755: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:37:52.863761: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:37:52.863828: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:37:52.863847: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:37:52.863856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:37:52.863865: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:37:52.863874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:37:52.863883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:37:52.863891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:37:52.863900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:37:52.863909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:37:52.863917: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:37:52.863926: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:37:52.863934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:37:52.863943: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:37:52.863951: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:37:52.863960: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:37:52.863969: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:37:52.863979: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:37:52.864058: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:37:52.864082: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:37:52.864099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:37:52.864113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:37:52.864128: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:37:52.864145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:37:52.864160: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:37:52.864180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:37:52.864194: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:37:52.864217: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:37:52.864231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:37:52.864252: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:37:52.864269: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:37:52.864283: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:37:52.864304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:37:52.864313: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:37:52.864321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:37:52.864329: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:37:52.864352: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:37:52.864369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:37:52.864377: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:37:52.864385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:37:52.864392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:37:52.864397: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:37:52.864412: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838b860 :: reshape/Reshape/shape [Const]
2018-11-27 09:37:52.864420: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838b8d8 :: conv1/Const [Const]
2018-11-27 09:37:52.864427: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838b950 :: conv1/pad_const [Const]
2018-11-27 09:37:52.864434: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838b9c8 :: fc1/Reshape/shape [Const]
2018-11-27 09:37:52.864441: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838ba40 :: squash/Const [Const]
2018-11-27 09:37:52.864449: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bab8 :: fc2/Const [Const]
2018-11-27 09:37:52.864456: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bb30 :: reshape/Reshape [Reshape]
2018-11-27 09:37:52.864463: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bbe8 :: conv1/Conv2D [Conv2D]
2018-11-27 09:37:52.864470: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bca0 :: conv1/Square [Square]
2018-11-27 09:37:52.864478: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bd38 :: conv1/Pad [Pad]
2018-11-27 09:37:52.864485: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bdf0 :: fc1/Reshape [Reshape]
2018-11-27 09:37:52.864492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bea8 :: fc1/MatMul [MatMul]
2018-11-27 09:37:52.864499: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bf60 :: fc1/Square [Square]
2018-11-27 09:37:52.864506: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x838bff8 :: fc2/MatMul [MatMul]
2018-11-27 09:37:52.864573: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:37:52.864624: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 7 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:37:52.864658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:37:52.864697: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:37:52.864708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 7, datatype: 1
2018-11-27 09:37:52.866647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:37:52.866667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:37:54z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:37:54.086164: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 7
2018-11-27 09:37:54.086284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:37:54.086316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 7
2018-11-27 09:37:54.086339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_7
2018-11-27 09:37:54.086493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:37:54.086638: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:37:54.086661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:37:54.086684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:37:54.086724: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:37:54.086777: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:37:54.086796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:37:54.086804: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:37:54.086811: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:37:54.086816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:37:54.086828: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:37:54.086860: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:37:54.086869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:37:54.086877: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:37:54.086886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:37:54.086915: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:37:54.086946: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:37:54.086954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:37:54.087053: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:37:54.087088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:37:54.087133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:37:54.087170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:37:54.087195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:37:54.087206: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:37:54.087214: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:37:54.087268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:37:54.087301: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:37:54.087316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:37:54.087332: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:37:54.087367: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:37:54.088270: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:37:54.088324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:37:54.088381: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:37:54.088432: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:37:54.088564: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 7
2018-11-27 09:37:54.088583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 7
[INFO] 2018-11-27T17:37:54z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:37:54.108003: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 7
[INFO] 2018-11-27T17:37:54z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:37:54.108643: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 7
2018-11-27 09:37:54.108658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 7
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 319	[ Parameter_140 ]
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 319	[ Constant_157 ]
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 395	Constant_157 took 13ms
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 319	[ Constant_154 ]
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:54z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 395	Constant_154 took 1152ms
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 319	[ Constant_150 ]
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 395	Constant_150 took 0ms
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 319	[ Constant_143 ]
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 395	Constant_143 took 1ms
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 319	[ Reshape_142 ]
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 395	Reshape_142 took 0ms
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 319	[ Reshape_145 ]
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 395	Reshape_145 took 0ms
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 319	[ Reshape_144 ]
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 395	Reshape_144 took 0ms
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 319	[ Convolution_146 ]
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:55z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 395	Convolution_146 took 3954ms
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 319	[ Reshape_147 ]
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 395	Reshape_147 took 0ms
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 319	[ Multiply_148 ]
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 395	Multiply_148 took 501ms
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 319	[ Pad_151 ]
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 395	Pad_151 took 5ms
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 319	[ Reshape_153 ]
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 395	Reshape_153 took 0ms
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 319	[ Dot_155 ]
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:37:59z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 395	Dot_155 took 10807ms
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 319	[ Multiply_156 ]
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 395	Multiply_156 took 46ms
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 319	[ Dot_158 ]
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:10z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:38:11z src/he_backend.cpp 395	Dot_158 took 254ms
[INFO] 2018-11-27T17:38:11z src/he_backend.cpp 319	[ Result_159 ]
[INFO] 2018-11-27T17:38:11z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:11z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:11z src/he_backend.cpp 395	Result_159 took 2ms
2018-11-27 09:38:11.087925: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 7
2018-11-27 09:38:11.297487: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 7
Result
[[-2.79766583 -4.09351873 7.20739174 6.62966442 -3.00705624 -3.87864494 -15.0946341 17.1012383 2.75366426 8.81703854]]
total time trial 7: 18.44214653968811
2018-11-27 09:38:11.309006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:38:11.309075: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:38:11.309107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:38:11.309141: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:38:11.309170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:38:11.309200: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:38:11.309241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:38:11.309273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:38:11.309307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:38:11.309344: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:38:11.309384: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:38:11.309396: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:38:11.309405: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:38:11.309415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:38:11.309424: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:38:11.309430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:38:11.309438: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:38:11.309444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:38:11.309452: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:38:11.309458: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:38:11.309514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:38:11.309534: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:38:11.309543: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:38:11.309551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:38:11.309561: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:38:11.309569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:38:11.309577: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:38:11.309586: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:38:11.309595: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:38:11.309603: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:38:11.309612: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:38:11.309620: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:38:11.309629: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:38:11.309637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:38:11.309646: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:38:11.309655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:38:11.309665: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:38:11.309745: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:38:11.309769: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:38:11.309787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:38:11.309801: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:38:11.309816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:38:11.309833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:38:11.309848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:38:11.309868: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:38:11.309882: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:38:11.309905: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:38:11.309919: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:38:11.309940: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:38:11.309956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:38:11.309970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:38:11.309991: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:38:11.310000: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:38:11.310008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:38:11.310016: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:38:11.310038: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:38:11.310047: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:38:11.310055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:38:11.310063: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:38:11.310069: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:38:11.310075: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:38:11.310092: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380480 :: reshape/Reshape/shape [Const]
2018-11-27 09:38:11.310100: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x83804f8 :: conv1/Const [Const]
2018-11-27 09:38:11.310107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380570 :: conv1/pad_const [Const]
2018-11-27 09:38:11.310114: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x83805e8 :: fc1/Reshape/shape [Const]
2018-11-27 09:38:11.310122: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380660 :: squash/Const [Const]
2018-11-27 09:38:11.310129: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x83806d8 :: fc2/Const [Const]
2018-11-27 09:38:11.310136: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380750 :: reshape/Reshape [Reshape]
2018-11-27 09:38:11.310143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380808 :: conv1/Conv2D [Conv2D]
2018-11-27 09:38:11.310150: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x83808c0 :: conv1/Square [Square]
2018-11-27 09:38:11.310158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380958 :: conv1/Pad [Pad]
2018-11-27 09:38:11.310165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380a10 :: fc1/Reshape [Reshape]
2018-11-27 09:38:11.310172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380ac8 :: fc1/MatMul [MatMul]
2018-11-27 09:38:11.310179: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380b80 :: fc1/Square [Square]
2018-11-27 09:38:11.310186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x8380c18 :: fc2/MatMul [MatMul]
2018-11-27 09:38:11.310253: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:38:11.310304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 8 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:38:11.310338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:38:11.310376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:38:11.310387: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 8, datatype: 1
2018-11-27 09:38:11.312361: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:38:11.312381: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:38:12z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:38:12.524290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 8
2018-11-27 09:38:12.524335: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:38:12.524345: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 8
2018-11-27 09:38:12.524351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_8
2018-11-27 09:38:12.524443: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:38:12.524516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:38:12.524539: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:38:12.524564: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:38:12.524608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:38:12.524659: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:38:12.524676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:38:12.524684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:38:12.524690: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:38:12.524696: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:38:12.524708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:38:12.524737: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:38:12.524745: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:38:12.524751: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:38:12.524760: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:38:12.524786: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:38:12.524799: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:38:12.524806: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:38:12.524905: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:38:12.524938: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:38:12.524983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:38:12.525016: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:38:12.525039: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:38:12.525048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:38:12.525055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:38:12.525108: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:38:12.525137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:38:12.525150: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:38:12.525163: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:38:12.525195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:38:12.525840: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:38:12.525892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:38:12.525930: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:38:12.525975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:38:12.526104: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 8
2018-11-27 09:38:12.526124: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 8
[INFO] 2018-11-27T17:38:12z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:38:12.552513: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 8
[INFO] 2018-11-27T17:38:12z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:38:12.552895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 8
2018-11-27 09:38:12.552909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 8
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 319	[ Parameter_160 ]
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 319	[ Constant_177 ]
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 395	Constant_177 took 8ms
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 319	[ Constant_174 ]
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:12z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 395	Constant_174 took 955ms
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 319	[ Constant_170 ]
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 395	Constant_170 took 0ms
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 319	[ Constant_163 ]
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 395	Constant_163 took 1ms
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 319	[ Reshape_162 ]
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 395	Reshape_162 took 0ms
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 319	[ Reshape_165 ]
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 395	Reshape_165 took 0ms
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 319	[ Reshape_164 ]
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 395	Reshape_164 took 0ms
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 319	[ Convolution_166 ]
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 395	Convolution_166 took 3753ms
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 319	[ Reshape_167 ]
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 395	Reshape_167 took 0ms
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 319	[ Multiply_168 ]
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 395	Multiply_168 took 331ms
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 319	[ Pad_171 ]
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 395	Pad_171 took 5ms
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 319	[ Reshape_173 ]
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 395	Reshape_173 took 0ms
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 319	[ Dot_175 ]
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:17z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 395	Dot_175 took 11021ms
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 319	[ Multiply_176 ]
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 395	Multiply_176 took 38ms
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 319	[ Dot_178 ]
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:28z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:38:29z src/he_backend.cpp 395	Dot_178 took 309ms
[INFO] 2018-11-27T17:38:29z src/he_backend.cpp 319	[ Result_179 ]
[INFO] 2018-11-27T17:38:29z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:29z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:29z src/he_backend.cpp 395	Result_179 took 2ms
2018-11-27 09:38:29.166773: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 8
2018-11-27 09:38:29.396433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 8
Result
[[-2.45591 -4.02023792 7.01927137 6.76100588 -3.31340027 -3.88925409 -15.2773418 17.2763367 2.44604635 8.61181545]]
total time trial 8: 18.096420288085938
2018-11-27 09:38:29.408074: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:38:29.408118: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:38:29.408144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:38:29.408152: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:38:29.408163: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:38:29.408181: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:38:29.408212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:38:29.408222: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:38:29.408234: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:38:29.408253: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:38:29.408263: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:38:29.408275: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:38:29.408284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:38:29.408294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:38:29.408302: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:38:29.408308: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:38:29.408316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:38:29.408322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:38:29.408330: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:38:29.408336: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:38:29.408403: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:38:29.408423: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:38:29.408433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:38:29.408441: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:38:29.408450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:38:29.408459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:38:29.408467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:38:29.408476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:38:29.408485: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:38:29.408494: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:38:29.408502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:38:29.408511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:38:29.408519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:38:29.408528: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:38:29.408537: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:38:29.408545: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:38:29.408555: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:38:29.408639: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:38:29.408664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:38:29.408683: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:38:29.408697: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:38:29.408712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:38:29.408729: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:38:29.408743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:38:29.408763: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:38:29.408777: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:38:29.408800: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:38:29.408814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:38:29.408835: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:38:29.408851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:38:29.408865: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:38:29.408886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:38:29.408894: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:38:29.408903: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:38:29.408911: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:38:29.408933: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:38:29.408941: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:38:29.408950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:38:29.408958: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:38:29.408964: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:38:29.408970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:38:29.408984: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x83793f0 :: reshape/Reshape/shape [Const]
2018-11-27 09:38:29.408992: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379468 :: conv1/Const [Const]
2018-11-27 09:38:29.408999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x83794e0 :: conv1/pad_const [Const]
2018-11-27 09:38:29.409007: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379558 :: fc1/Reshape/shape [Const]
2018-11-27 09:38:29.409014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x83795d0 :: squash/Const [Const]
2018-11-27 09:38:29.409021: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379648 :: fc2/Const [Const]
2018-11-27 09:38:29.409029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x83796c0 :: reshape/Reshape [Reshape]
2018-11-27 09:38:29.409036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379778 :: conv1/Conv2D [Conv2D]
2018-11-27 09:38:29.409043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379830 :: conv1/Square [Square]
2018-11-27 09:38:29.409050: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x83798c8 :: conv1/Pad [Pad]
2018-11-27 09:38:29.409058: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379980 :: fc1/Reshape [Reshape]
2018-11-27 09:38:29.409065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379a38 :: fc1/MatMul [MatMul]
2018-11-27 09:38:29.409072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379af0 :: fc1/Square [Square]
2018-11-27 09:38:29.409079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x8379b88 :: fc2/MatMul [MatMul]
2018-11-27 09:38:29.409145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:38:29.409197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 9 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:38:29.409233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:38:29.409273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:38:29.409284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 9, datatype: 1
2018-11-27 09:38:29.411142: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:38:29.411163: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:38:30z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:38:30.632137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 9
2018-11-27 09:38:30.632184: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:38:30.632194: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 9
2018-11-27 09:38:30.632202: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_9
2018-11-27 09:38:30.632311: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:38:30.632419: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:38:30.632450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:38:30.632477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:38:30.632519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:38:30.632573: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:38:30.632592: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:38:30.632599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:38:30.632605: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:38:30.632611: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:38:30.632622: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:38:30.632652: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:38:30.632659: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:38:30.632666: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:38:30.632674: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:38:30.632699: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:38:30.632713: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:38:30.632720: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:38:30.632821: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:38:30.632854: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:38:30.632904: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:38:30.632937: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:38:30.632962: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:38:30.632972: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:38:30.632979: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:38:30.633035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:38:30.633064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:38:30.633077: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:38:30.633090: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:38:30.633122: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:38:30.633746: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:38:30.633797: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:38:30.633834: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:38:30.633876: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:38:30.634007: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 9
2018-11-27 09:38:30.634027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 9
[INFO] 2018-11-27T17:38:30z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:38:30.660551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 9
[INFO] 2018-11-27T17:38:30z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:38:30.661369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 9
2018-11-27 09:38:30.661402: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 9
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 319	[ Parameter_180 ]
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 319	[ Constant_197 ]
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 395	Constant_197 took 11ms
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 319	[ Constant_194 ]
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:30z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 395	Constant_194 took 1036ms
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 319	[ Constant_190 ]
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 395	Constant_190 took 0ms
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 319	[ Constant_183 ]
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 395	Constant_183 took 3ms
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 319	[ Reshape_182 ]
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 395	Reshape_182 took 0ms
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 319	[ Reshape_185 ]
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 395	Reshape_185 took 0ms
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 319	[ Reshape_184 ]
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 395	Reshape_184 took 0ms
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 319	[ Convolution_186 ]
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:35z src/he_backend.cpp 395	Convolution_186 took 3771ms
[INFO] 2018-11-27T17:38:35z src/he_backend.cpp 319	[ Reshape_187 ]
[INFO] 2018-11-27T17:38:35z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:35z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:35z src/he_backend.cpp 395	Reshape_187 took 0ms
[INFO] 2018-11-27T17:38:35z src/he_backend.cpp 319	[ Multiply_188 ]
[INFO] 2018-11-27T17:38:35z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:38:35z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 395	Multiply_188 took 398ms
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 319	[ Pad_191 ]
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 395	Pad_191 took 8ms
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 319	[ Reshape_193 ]
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 395	Reshape_193 took 0ms
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 319	[ Dot_195 ]
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:36z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 395	Dot_195 took 11086ms
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 319	[ Multiply_196 ]
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 395	Multiply_196 took 131ms
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 319	[ Dot_198 ]
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 395	Dot_198 took 269ms
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 319	[ Result_199 ]
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:47z src/he_backend.cpp 395	Result_199 took 1ms
2018-11-27 09:38:47.552675: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 9
2018-11-27 09:38:47.868594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 9
Result
[[-1.5279429 -3.57526827 6.32766962 6.65665436 -3.709589 -3.93444586 -15.1636724 17.1125031 1.5920887 7.95699692]]
total time trial 9: 18.46769952774048
2018-11-27 09:38:47.878494: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 09:38:47.878525: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 09:38:47.878534: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 09:38:47.878559: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 09:38:47.878570: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 09:38:47.878598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 09:38:47.878614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 09:38:47.878624: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 09:38:47.878637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 09:38:47.878648: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 09:38:47.878657: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 09:38:47.878668: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 09:38:47.878676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 09:38:47.878685: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 09:38:47.878693: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 09:38:47.878698: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 09:38:47.878705: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 09:38:47.878711: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 09:38:47.878719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 09:38:47.878733: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:38:47.878786: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 09:38:47.878804: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 09:38:47.878812: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 09:38:47.878821: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 09:38:47.878830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 09:38:47.878839: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 09:38:47.878847: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 09:38:47.878856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 09:38:47.878865: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 09:38:47.878874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 09:38:47.878882: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 09:38:47.878891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 09:38:47.878899: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 09:38:47.878908: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 09:38:47.878916: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 09:38:47.878926: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 09:38:47.878935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 09:38:47.879012: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 09:38:47.879035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 09:38:47.879052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 09:38:47.879066: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 09:38:47.879082: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 09:38:47.879099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 09:38:47.879113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 09:38:47.879133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 09:38:47.879147: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 09:38:47.879170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 09:38:47.879184: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 09:38:47.879204: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 09:38:47.879221: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 09:38:47.879235: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 09:38:47.879256: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:38:47.879265: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:38:47.879273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:38:47.879282: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:38:47.879304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 09:38:47.879312: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 09:38:47.879320: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 09:38:47.879328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 09:38:47.879334: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 09:38:47.879340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 09:38:47.879354: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d2b0 :: reshape/Reshape/shape [Const]
2018-11-27 09:38:47.879362: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d328 :: conv1/Const [Const]
2018-11-27 09:38:47.879369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d3a0 :: conv1/pad_const [Const]
2018-11-27 09:38:47.879376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d418 :: fc1/Reshape/shape [Const]
2018-11-27 09:38:47.879384: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d490 :: squash/Const [Const]
2018-11-27 09:38:47.879391: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d508 :: fc2/Const [Const]
2018-11-27 09:38:47.879398: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d580 :: reshape/Reshape [Reshape]
2018-11-27 09:38:47.879405: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d638 :: conv1/Conv2D [Conv2D]
2018-11-27 09:38:47.879412: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d6f0 :: conv1/Square [Square]
2018-11-27 09:38:47.879420: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d788 :: conv1/Pad [Pad]
2018-11-27 09:38:47.879427: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d840 :: fc1/Reshape [Reshape]
2018-11-27 09:38:47.879434: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d8f8 :: fc1/MatMul [MatMul]
2018-11-27 09:38:47.879442: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862d9b0 :: fc1/Square [Square]
2018-11-27 09:38:47.879449: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x862da48 :: fc2/MatMul [MatMul]
2018-11-27 09:38:47.879514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 09:38:47.879565: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 10 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 09:38:47.879600: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to fc2/Print[0] in -1, datatype: 1
2018-11-27 09:38:47.879637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to fc2/Print[1] in -1, datatype: 1
2018-11-27 09:38:47.879648: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 10, datatype: 1
2018-11-27 09:38:47.881413: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 09:38:47.881433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T17:38:48z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
2018-11-27 09:38:49.008429: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 10
2018-11-27 09:38:49.008465: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 09:38:49.008473: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 10
2018-11-27 09:38:49.008479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_10
2018-11-27 09:38:49.008545: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 09:38:49.008624: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 09:38:49.008645: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 09:38:49.008668: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 09:38:49.008708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 09:38:49.008757: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 09:38:49.008774: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 09:38:49.008782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 09:38:49.008788: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 09:38:49.008793: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 09:38:49.008805: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 09:38:49.008835: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 09:38:49.008843: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 09:38:49.008850: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 09:38:49.008858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 09:38:49.008885: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 09:38:49.008897: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 09:38:49.008904: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 09:38:49.009003: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 09:38:49.009035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 09:38:49.009079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 09:38:49.009111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 09:38:49.009134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 09:38:49.009143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 09:38:49.009150: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 09:38:49.009202: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 09:38:49.009230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 09:38:49.009243: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 09:38:49.009256: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 09:38:49.009289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 09:38:49.009905: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 09:38:49.009952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 09:38:49.009987: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 09:38:49.010027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 09:38:49.010148: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 10
2018-11-27 09:38:49.010165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 10
[INFO] 2018-11-27T17:38:49z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 09:38:49.037820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 10
[INFO] 2018-11-27T17:38:49z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 09:38:49.038233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 10
2018-11-27 09:38:49.038248: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 10
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 319	[ Parameter_200 ]
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 319	[ Constant_217 ]
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 395	Constant_217 took 10ms
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 319	[ Constant_214 ]
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:49z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 395	Constant_214 took 1012ms
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 319	[ Constant_210 ]
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 395	Constant_210 took 0ms
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 319	[ Constant_203 ]
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 395	Constant_203 took 2ms
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 319	[ Reshape_202 ]
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 395	Reshape_202 took 0ms
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 319	[ Reshape_205 ]
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 395	Reshape_205 took 0ms
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 319	[ Reshape_204 ]
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 395	Reshape_204 took 0ms
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 319	[ Convolution_206 ]
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:53z src/he_backend.cpp 395	Convolution_206 took 3750ms
[INFO] 2018-11-27T17:38:53z src/he_backend.cpp 319	[ Reshape_207 ]
[INFO] 2018-11-27T17:38:53z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:53z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:53z src/he_backend.cpp 395	Reshape_207 took 0ms
[INFO] 2018-11-27T17:38:53z src/he_backend.cpp 319	[ Multiply_208 ]
[INFO] 2018-11-27T17:38:53z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:38:53z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 395	Multiply_208 took 307ms
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 319	[ Pad_211 ]
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 395	Pad_211 took 5ms
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 319	[ Reshape_213 ]
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 395	Reshape_213 took 0ms
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 319	[ Dot_215 ]
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:38:54z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 395	Dot_215 took 10982ms
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 319	[ Multiply_216 ]
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 395	Multiply_216 took 115ms
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 319	[ Dot_218 ]
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 395	Dot_218 took 263ms
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 319	[ Result_219 ]
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T17:39:05z src/he_backend.cpp 395	Result_219 took 1ms
2018-11-27 09:39:05.666950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 10
2018-11-27 09:39:05.876988: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 10
Result
[[-0.931075752 -3.47343373 6.02604675 6.76676941 -4.10569763 -3.98530626 -15.4051275 17.3369942 1.13601184 7.54357338]]
total time trial 10: 18.006207704544067
/nfs/site/home/fboemer/repos/he-transformer/experiments/CryptoNets
(he3) ➜  CryptoNets git:(fboemer/cryptonets-timings) ✗
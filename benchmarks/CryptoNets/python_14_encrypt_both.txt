(he3) ➜  CryptoNets git:(fboemer/cryptonets-timings) ✗ ./run_python_timings_encrypt_both_14.sh
TensorFlow version installed: 1.12.0 (v1.12.0-0-ga6d8ffae09)
nGraph bridge built with: 1.12.0 (v1.12.0-0-ga6d8ffae09)
Extracting /tmp/tensorflow/mnist/input_data/train-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/train-labels-idx1-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-labels-idx1-ubyte.gz
2018-11-27 15:58:16.593642: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2018-11-27 15:58:16.627667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 15:58:16.627696: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 15:58:16.627705: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 15:58:16.627714: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 15:58:16.627722: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 15:58:16.627730: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 15:58:16.627741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 15:58:16.627759: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 15:58:16.627768: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 15:58:16.627778: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 15:58:16.627787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 15:58:16.627796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 15:58:16.627805: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 15:58:16.627814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 15:58:16.627822: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 15:58:16.627828: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 15:58:16.627835: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 15:58:16.627842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 15:58:16.627849: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 15:58:16.627855: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:58:16.627894: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 15:58:16.627910: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 15:58:16.627919: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 15:58:16.627927: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 15:58:16.627937: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 15:58:16.627946: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 15:58:16.627954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 15:58:16.627963: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 15:58:16.627972: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 15:58:16.627980: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 15:58:16.627989: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 15:58:16.627998: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 15:58:16.628006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 15:58:16.628014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 15:58:16.628023: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 15:58:16.628032: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 15:58:16.628043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 15:58:16.628114: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 15:58:16.628136: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 15:58:16.628153: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 15:58:16.628167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 15:58:16.628181: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 15:58:16.628198: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 15:58:16.628212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 15:58:16.628232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 15:58:16.628246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 15:58:16.628268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 15:58:16.628282: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 15:58:16.628303: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 15:58:16.628318: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 15:58:16.628332: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 15:58:16.628353: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:58:16.628367: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:58:16.628376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:58:16.628383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:58:16.628406: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 15:58:16.628414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 15:58:16.628422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 15:58:16.628430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 15:58:16.628436: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 15:58:16.628442: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 15:58:16.628458: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf2c0 :: reshape/Reshape/shape [Const]
2018-11-27 15:58:16.628466: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf338 :: conv1/Const [Const]
2018-11-27 15:58:16.628473: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf3b0 :: conv1/pad_const [Const]
2018-11-27 15:58:16.628480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf428 :: fc1/Reshape/shape [Const]
2018-11-27 15:58:16.628487: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf4a0 :: squash/Const [Const]
2018-11-27 15:58:16.628495: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf518 :: fc2/Const [Const]
2018-11-27 15:58:16.628502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf590 :: reshape/Reshape [Reshape]
2018-11-27 15:58:16.628510: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf648 :: conv1/Conv2D [Conv2D]
2018-11-27 15:58:16.628517: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf700 :: conv1/Square [Square]
2018-11-27 15:58:16.628524: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf798 :: conv1/Pad [Pad]
2018-11-27 15:58:16.628531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf850 :: fc1/Reshape [Reshape]
2018-11-27 15:58:16.628538: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf908 :: fc1/MatMul [MatMul]
2018-11-27 15:58:16.628545: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cf9c0 :: fc1/Square [Square]
2018-11-27 15:58:16.628553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x45cfa58 :: fc2/MatMul [MatMul]
2018-11-27 15:58:16.628618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 15:58:16.628667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 0 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 15:58:16.628700: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to fc2/Print[0] in -1, datatype: 1
2018-11-27 15:58:16.628735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to fc2/Print[1] in -1, datatype: 1
2018-11-27 15:58:16.628746: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 0, datatype: 1
2018-11-27 15:58:16.630570: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 15:58:16.630638: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T23:58:16z src/seal/ckks/he_seal_ckks_backend.cpp 66	Using SEAL CKKS config with 7 40-bit coefficients
[INFO] 2018-11-27T23:58:18z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 15:58:18.990242: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 0
2018-11-27 15:58:18.990349: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 15:58:18.990382: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 0
2018-11-27 15:58:18.990405: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_0
2018-11-27 15:58:18.990645: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 15:58:18.990842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 15:58:18.990865: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 15:58:18.990890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 15:58:18.990936: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 15:58:18.990985: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 15:58:18.991005: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 15:58:18.991012: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 15:58:18.991018: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 15:58:18.991023: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 15:58:18.991040: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 15:58:18.991070: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 15:58:18.991077: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 15:58:18.991084: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 15:58:18.991093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 15:58:18.991119: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 15:58:18.991132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 15:58:18.991139: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 15:58:18.991239: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 15:58:18.991272: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 15:58:18.991313: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 15:58:18.991347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 15:58:18.991379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 15:58:18.991388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 15:58:18.991395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 15:58:18.991447: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 15:58:18.991475: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 15:58:18.991488: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 15:58:18.991501: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 15:58:18.991534: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 15:58:18.992316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 15:58:18.992373: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 15:58:18.992410: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 15:58:18.992451: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 15:58:18.992579: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 0
2018-11-27 15:58:18.992607: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 0
[INFO] 2018-11-27T23:58:18z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 15:58:19.288015: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 0
[INFO] 2018-11-27T23:58:19z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 15:58:19.310294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 0
2018-11-27 15:58:19.310354: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 0
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 319	[ Parameter_0 ]
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 319	[ Constant_17 ]
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 395	Constant_17 took 272ms
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 319	[ Constant_14 ]
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:58:19z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 395	Constant_14 took 17258ms
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 319	[ Constant_10 ]
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 395	Constant_10 took 35ms
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 319	[ Constant_3 ]
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 395	Constant_3 took 75ms
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 319	[ Reshape_2 ]
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 395	Reshape_2 took 0ms
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 319	[ Reshape_5 ]
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 395	Reshape_5 took 0ms
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 319	[ Reshape_4 ]
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 395	Reshape_4 took 0ms
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 319	[ Convolution_6 ]
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:58:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:59:01z src/he_backend.cpp 395	Convolution_6 took 23650ms
[INFO] 2018-11-27T23:59:01z src/he_backend.cpp 319	[ Reshape_7 ]
[INFO] 2018-11-27T23:59:01z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:59:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:59:01z src/he_backend.cpp 395	Reshape_7 took 0ms
[INFO] 2018-11-27T23:59:01z src/he_backend.cpp 319	[ Multiply_8 ]
[INFO] 2018-11-27T23:59:01z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:59:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 395	Multiply_8 took 838ms
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 319	[ Pad_11 ]
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 395	Pad_11 took 0ms
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 319	[ Reshape_13 ]
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 395	Reshape_13 took 0ms
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 319	[ Dot_15 ]
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T23:59:02z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 395	Dot_15 took 90306ms
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 319	[ Multiply_16 ]
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 395	Multiply_16 took 122ms
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 319	[ Dot_18 ]
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:00:32z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:00:33z src/he_backend.cpp 395	Dot_18 took 1350ms
[INFO] 2018-11-28T00:00:33z src/he_backend.cpp 319	[ Result_19 ]
[INFO] 2018-11-28T00:00:33z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:00:33z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:00:33z src/he_backend.cpp 395	Result_19 took 5ms
2018-11-27 16:00:33.918144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 0
2018-11-27 16:00:34.255233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 0
Result
[[-1.74164426 -3.76110125 6.59273863 6.78492928 -3.68082547 -3.98619628 -15.4452896 17.4299736 1.82926941 8.19701]]
total time warmup: 137.63906264305115
2018-11-27 16:00:34.274589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:00:34.274627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:00:34.274638: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:00:34.274648: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:00:34.274657: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:00:34.274666: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:00:34.274679: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:00:34.274688: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:00:34.274700: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:00:34.274711: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:00:34.274720: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:00:34.274730: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:00:34.274739: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:00:34.274757: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:00:34.274771: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:00:34.274780: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:00:34.274788: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:00:34.274796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:00:34.274804: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:00:34.274814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:00:34.274866: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:00:34.274886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:00:34.274894: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:00:34.274904: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:00:34.274913: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:00:34.274922: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:00:34.274930: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:00:34.274939: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:00:34.274948: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:00:34.274957: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:00:34.274965: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:00:34.274974: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:00:34.274982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:00:34.274991: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:00:34.274999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:00:34.275008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:00:34.275017: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:00:34.275093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:00:34.275116: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:00:34.275133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:00:34.275147: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:00:34.275162: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:00:34.275178: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:00:34.275193: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:00:34.275212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:00:34.275226: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:00:34.275248: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:00:34.275262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:00:34.275283: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:00:34.275299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:00:34.275312: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:00:34.275333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:00:34.275341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:00:34.275349: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:00:34.275357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:00:34.275380: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:00:34.275388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:00:34.275396: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:00:34.275404: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:00:34.275410: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:00:34.275416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:00:34.275431: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x9888460 :: reshape/Reshape/shape [Const]
2018-11-27 16:00:34.275439: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x98884d8 :: conv1/Const [Const]
2018-11-27 16:00:34.275446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x9888550 :: conv1/pad_const [Const]
2018-11-27 16:00:34.275454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x98885c8 :: fc1/Reshape/shape [Const]
2018-11-27 16:00:34.275461: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x9888640 :: squash/Const [Const]
2018-11-27 16:00:34.275468: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x98886b8 :: fc2/Const [Const]
2018-11-27 16:00:34.275475: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x9888730 :: reshape/Reshape [Reshape]
2018-11-27 16:00:34.275482: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x98887e8 :: conv1/Conv2D [Conv2D]
2018-11-27 16:00:34.275489: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x98888a0 :: conv1/Square [Square]
2018-11-27 16:00:34.275496: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x9888938 :: conv1/Pad [Pad]
2018-11-27 16:00:34.275503: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x98889f0 :: fc1/Reshape [Reshape]
2018-11-27 16:00:34.275510: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x9888aa8 :: fc1/MatMul [MatMul]
2018-11-27 16:00:34.275517: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x9888b60 :: fc1/Square [Square]
2018-11-27 16:00:34.275525: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x9888bf8 :: fc2/MatMul [MatMul]
2018-11-27 16:00:34.275589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:00:34.275637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 1 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:00:34.275670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:00:34.275706: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:00:34.275717: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 1, datatype: 1
2018-11-27 16:00:34.276428: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:00:34.276448: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:00:36z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:00:36.599124: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 1
2018-11-27 16:00:36.599184: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:00:36.599197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 1
2018-11-27 16:00:36.599205: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_1
2018-11-27 16:00:36.599331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:00:36.599415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:00:36.599441: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:00:36.599467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:00:36.599507: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:00:36.599557: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:00:36.599575: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:00:36.599583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:00:36.599588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:00:36.599594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:00:36.599606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:00:36.599639: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:00:36.599647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:00:36.599654: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:00:36.599663: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:00:36.599689: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:00:36.599702: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:00:36.599709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:00:36.599811: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:00:36.599845: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:00:36.599892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:00:36.599925: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:00:36.599953: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:00:36.599963: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:00:36.599969: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:00:36.600024: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:00:36.600053: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:00:36.600066: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:00:36.600079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:00:36.600114: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:00:36.600892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:00:36.600942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:00:36.600978: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:00:36.601017: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:00:36.601141: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 1
2018-11-27 16:00:36.601163: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 1
[INFO] 2018-11-28T00:00:36z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:00:36.847446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 1
[INFO] 2018-11-28T00:00:36z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:00:36.847909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 1
2018-11-27 16:00:36.847922: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 1
[INFO] 2018-11-28T00:00:36z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:00:36z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:00:36z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 319	[ Parameter_20 ]
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 319	[ Constant_37 ]
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 395	Constant_37 took 344ms
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 319	[ Constant_34 ]
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:00:37z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 395	Constant_34 took 24043ms
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 319	[ Constant_30 ]
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 395	Constant_30 took 10ms
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 319	[ Constant_23 ]
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 395	Constant_23 took 75ms
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 319	[ Reshape_22 ]
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 395	Reshape_22 took 0ms
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 319	[ Reshape_25 ]
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 395	Reshape_25 took 0ms
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 319	[ Reshape_24 ]
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 395	Reshape_24 took 0ms
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 319	[ Convolution_26 ]
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:01:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:28z src/he_backend.cpp 395	Convolution_26 took 26576ms
[INFO] 2018-11-28T00:01:28z src/he_backend.cpp 319	[ Reshape_27 ]
[INFO] 2018-11-28T00:01:28z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:01:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:28z src/he_backend.cpp 395	Reshape_27 took 0ms
[INFO] 2018-11-28T00:01:28z src/he_backend.cpp 319	[ Multiply_28 ]
[INFO] 2018-11-28T00:01:28z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:01:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 395	Multiply_28 took 810ms
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 319	[ Pad_31 ]
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 395	Pad_31 took 0ms
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 319	[ Reshape_33 ]
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 395	Reshape_33 took 0ms
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 319	[ Dot_35 ]
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:01:29z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 395	Dot_35 took 94652ms
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 319	[ Multiply_36 ]
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 395	Multiply_36 took 112ms
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 319	[ Dot_38 ]
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:03z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:03:05z src/he_backend.cpp 395	Dot_38 took 1253ms
[INFO] 2018-11-28T00:03:05z src/he_backend.cpp 319	[ Result_39 ]
[INFO] 2018-11-28T00:03:05z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:03:05z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:03:05z src/he_backend.cpp 395	Result_39 took 3ms
2018-11-27 16:03:05.047206: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 1
2018-11-27 16:03:05.564969: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 1
Result
[[-1.723593 -3.75467277 6.58130121 6.78572845 -3.6905961 -3.98697758 -15.4471731 17.4314671 1.81385529 8.18513107]]
total time trial 1: 151.30385661125183
2018-11-27 16:03:05.578298: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:03:05.578384: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:03:05.578417: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:03:05.578450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:03:05.578488: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:03:05.578498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:03:05.578512: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:03:05.578523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:03:05.578535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:03:05.578548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:03:05.578558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:03:05.578569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:03:05.578580: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:03:05.578591: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:03:05.578600: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:03:05.578607: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:03:05.578614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:03:05.578621: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:03:05.578628: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:03:05.578635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:03:05.578691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:03:05.578709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:03:05.578718: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:03:05.578727: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:03:05.578736: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:03:05.578745: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:03:05.578754: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:03:05.578762: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:03:05.578771: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:03:05.578780: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:03:05.578789: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:03:05.578798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:03:05.578807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:03:05.578815: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:03:05.578824: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:03:05.578833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:03:05.578842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:03:05.578919: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:03:05.578943: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:03:05.578960: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:03:05.578974: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:03:05.578989: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:03:05.579006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:03:05.579020: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:03:05.579040: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:03:05.579055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:03:05.579077: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:03:05.579091: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:03:05.579112: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:03:05.579128: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:03:05.579142: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:03:05.579163: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:03:05.579171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:03:05.579180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:03:05.579188: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:03:05.579210: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:03:05.579218: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:03:05.579226: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:03:05.579234: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:03:05.579241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:03:05.579246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:03:05.579263: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9880f30 :: reshape/Reshape/shape [Const]
2018-11-27 16:03:05.579271: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9880fa8 :: conv1/Const [Const]
2018-11-27 16:03:05.579278: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881020 :: conv1/pad_const [Const]
2018-11-27 16:03:05.579285: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881098 :: fc1/Reshape/shape [Const]
2018-11-27 16:03:05.579293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881110 :: squash/Const [Const]
2018-11-27 16:03:05.579300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881188 :: fc2/Const [Const]
2018-11-27 16:03:05.579307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881200 :: reshape/Reshape [Reshape]
2018-11-27 16:03:05.579314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x98812b8 :: conv1/Conv2D [Conv2D]
2018-11-27 16:03:05.579321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881370 :: conv1/Square [Square]
2018-11-27 16:03:05.579328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881408 :: conv1/Pad [Pad]
2018-11-27 16:03:05.579336: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x98814c0 :: fc1/Reshape [Reshape]
2018-11-27 16:03:05.579343: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881578 :: fc1/MatMul [MatMul]
2018-11-27 16:03:05.579350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x9881630 :: fc1/Square [Square]
2018-11-27 16:03:05.579357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x98816c8 :: fc2/MatMul [MatMul]
2018-11-27 16:03:05.579422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:03:05.579471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 2 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:03:05.579506: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:03:05.579544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:03:05.579555: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 2, datatype: 1
2018-11-27 16:03:05.581083: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:03:05.581105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:03:07z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:03:07.858166: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 2
2018-11-27 16:03:07.858239: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:03:07.858267: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 2
2018-11-27 16:03:07.858288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_2
2018-11-27 16:03:07.858448: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:03:07.858523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:03:07.858548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:03:07.858572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:03:07.858612: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:03:07.858662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:03:07.858681: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:03:07.858688: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:03:07.858694: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:03:07.858700: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:03:07.858713: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:03:07.858743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:03:07.858751: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:03:07.858758: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:03:07.858766: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:03:07.858793: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:03:07.858805: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:03:07.858812: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:03:07.858931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:03:07.858964: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:03:07.859007: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:03:07.859040: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:03:07.859064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:03:07.859073: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:03:07.859080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:03:07.859134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:03:07.859163: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:03:07.859176: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:03:07.859189: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:03:07.859221: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:03:07.859881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:03:07.859934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:03:07.859971: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:03:07.860015: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:03:07.860144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 2
2018-11-27 16:03:07.860164: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 2
[INFO] 2018-11-28T00:03:07z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:03:07.899803: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 2
[INFO] 2018-11-28T00:03:07z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:03:07.900424: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 2
2018-11-27 16:03:07.900438: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 2
[INFO] 2018-11-28T00:03:07z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:03:07z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:03:07z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 319	[ Parameter_40 ]
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 319	[ Constant_57 ]
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 395	Constant_57 took 274ms
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 319	[ Constant_54 ]
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:03:08z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 395	Constant_54 took 20299ms
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 319	[ Constant_50 ]
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 395	Constant_50 took 11ms
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 319	[ Constant_43 ]
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 395	Constant_43 took 93ms
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 319	[ Reshape_42 ]
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 395	Reshape_42 took 0ms
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 319	[ Reshape_45 ]
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 395	Reshape_45 took 0ms
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 319	[ Reshape_44 ]
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 395	Reshape_44 took 0ms
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 319	[ Convolution_46 ]
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:03:28z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:56z src/he_backend.cpp 395	Convolution_46 took 27779ms
[INFO] 2018-11-28T00:03:56z src/he_backend.cpp 319	[ Reshape_47 ]
[INFO] 2018-11-28T00:03:56z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:03:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:56z src/he_backend.cpp 395	Reshape_47 took 0ms
[INFO] 2018-11-28T00:03:56z src/he_backend.cpp 319	[ Multiply_48 ]
[INFO] 2018-11-28T00:03:56z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:03:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 395	Multiply_48 took 746ms
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 319	[ Pad_51 ]
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 395	Pad_51 took 0ms
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 319	[ Reshape_53 ]
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 395	Reshape_53 took 0ms
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 319	[ Dot_55 ]
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:03:57z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 395	Dot_55 took 96219ms
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 319	[ Multiply_56 ]
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 395	Multiply_56 took 96ms
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 319	[ Dot_58 ]
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:33z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:05:34z src/he_backend.cpp 395	Dot_58 took 1270ms
[INFO] 2018-11-28T00:05:34z src/he_backend.cpp 319	[ Result_59 ]
[INFO] 2018-11-28T00:05:34z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:05:34z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:05:34z src/he_backend.cpp 395	Result_59 took 4ms
2018-11-27 16:05:34.972196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 2
2018-11-27 16:05:35.476448: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 2
Result
[[-1.74243605 -3.76108861 6.59333658 6.78487349 -3.68002129 -3.98618865 -15.444952 17.4296856 1.83017886 8.19728565]]
total time trial 2: 149.90719938278198
2018-11-27 16:05:35.488467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:05:35.488548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:05:35.488558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:05:35.488567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:05:35.488574: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:05:35.488583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:05:35.488596: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:05:35.488610: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:05:35.488621: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:05:35.488633: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:05:35.488642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:05:35.488653: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:05:35.488662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:05:35.488672: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:05:35.488680: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:05:35.488687: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:05:35.488695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:05:35.488701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:05:35.488709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:05:35.488715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:05:35.488770: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:05:35.488789: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:05:35.488798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:05:35.488806: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:05:35.488816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:05:35.488824: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:05:35.488833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:05:35.488841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:05:35.488850: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:05:35.488859: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:05:35.488868: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:05:35.488877: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:05:35.488885: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:05:35.488894: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:05:35.488903: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:05:35.488912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:05:35.488922: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:05:35.489001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:05:35.489024: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:05:35.489042: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:05:35.489056: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:05:35.489071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:05:35.489088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:05:35.489102: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:05:35.489122: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:05:35.489136: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:05:35.489159: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:05:35.489173: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:05:35.489194: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:05:35.489210: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:05:35.489223: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:05:35.489245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:05:35.489253: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:05:35.489261: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:05:35.489269: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:05:35.489291: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:05:35.489299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:05:35.489307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:05:35.489315: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:05:35.489321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:05:35.489327: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:05:35.489342: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989a9a0 :: reshape/Reshape/shape [Const]
2018-11-27 16:05:35.489350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989aa18 :: conv1/Const [Const]
2018-11-27 16:05:35.489357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989aa90 :: conv1/pad_const [Const]
2018-11-27 16:05:35.489364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989ab08 :: fc1/Reshape/shape [Const]
2018-11-27 16:05:35.489372: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989ab80 :: squash/Const [Const]
2018-11-27 16:05:35.489379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989abf8 :: fc2/Const [Const]
2018-11-27 16:05:35.489386: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989ac70 :: reshape/Reshape [Reshape]
2018-11-27 16:05:35.489393: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989ad28 :: conv1/Conv2D [Conv2D]
2018-11-27 16:05:35.489400: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989ade0 :: conv1/Square [Square]
2018-11-27 16:05:35.489408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989ae78 :: conv1/Pad [Pad]
2018-11-27 16:05:35.489415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989af30 :: fc1/Reshape [Reshape]
2018-11-27 16:05:35.489422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989afe8 :: fc1/MatMul [MatMul]
2018-11-27 16:05:35.489429: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989b0a0 :: fc1/Square [Square]
2018-11-27 16:05:35.489436: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x989b138 :: fc2/MatMul [MatMul]
2018-11-27 16:05:35.489502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:05:35.489551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 3 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:05:35.489585: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:05:35.489625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:05:35.489636: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 3, datatype: 1
2018-11-27 16:05:35.491411: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:05:35.491461: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:05:37z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:05:37.866593: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 3
2018-11-27 16:05:37.866670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:05:37.866684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 3
2018-11-27 16:05:37.866699: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_3
2018-11-27 16:05:37.866816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:05:37.866913: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:05:37.866945: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:05:37.866970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:05:37.867011: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:05:37.867062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:05:37.867080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:05:37.867088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:05:37.867093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:05:37.867099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:05:37.867111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:05:37.867142: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:05:37.867149: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:05:37.867156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:05:37.867165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:05:37.867192: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:05:37.867205: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:05:37.867212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:05:37.867304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:05:37.867337: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:05:37.867383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:05:37.867417: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:05:37.867444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:05:37.867453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:05:37.867460: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:05:37.867514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:05:37.867544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:05:37.867557: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:05:37.867570: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:05:37.867603: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:05:37.868437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:05:37.868500: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:05:37.868536: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:05:37.868582: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:05:37.868708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 3
2018-11-27 16:05:37.868727: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 3
[INFO] 2018-11-28T00:05:37z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:05:37.905357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 3
[INFO] 2018-11-28T00:05:37z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:05:37.905703: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 3
2018-11-27 16:05:37.905715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 3
[INFO] 2018-11-28T00:05:37z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:05:37z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:05:37z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 319	[ Parameter_60 ]
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 319	[ Constant_77 ]
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 395	Constant_77 took 261ms
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 319	[ Constant_74 ]
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:05:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 395	Constant_74 took 20097ms
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 319	[ Constant_70 ]
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 395	Constant_70 took 10ms
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 319	[ Constant_63 ]
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 395	Constant_63 took 59ms
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 319	[ Reshape_62 ]
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 395	Reshape_62 took 0ms
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 319	[ Reshape_65 ]
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 395	Reshape_65 took 0ms
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 319	[ Reshape_64 ]
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 395	Reshape_64 took 0ms
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 319	[ Convolution_66 ]
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:05:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:06:26z src/he_backend.cpp 395	Convolution_66 took 27803ms
[INFO] 2018-11-28T00:06:26z src/he_backend.cpp 319	[ Reshape_67 ]
[INFO] 2018-11-28T00:06:26z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:06:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:06:26z src/he_backend.cpp 395	Reshape_67 took 0ms
[INFO] 2018-11-28T00:06:26z src/he_backend.cpp 319	[ Multiply_68 ]
[INFO] 2018-11-28T00:06:26z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:06:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 395	Multiply_68 took 716ms
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 319	[ Pad_71 ]
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 395	Pad_71 took 0ms
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 319	[ Reshape_73 ]
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 395	Reshape_73 took 0ms
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 319	[ Dot_75 ]
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:06:27z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 395	Dot_75 took 93936ms
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 319	[ Multiply_76 ]
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 395	Multiply_76 took 95ms
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 319	[ Dot_78 ]
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:01z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:08:02z src/he_backend.cpp 395	Dot_78 took 1193ms
[INFO] 2018-11-28T00:08:02z src/he_backend.cpp 319	[ Result_79 ]
[INFO] 2018-11-28T00:08:02z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:08:02z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:08:02z src/he_backend.cpp 395	Result_79 took 4ms
2018-11-27 16:08:02.375689: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 3
2018-11-27 16:08:02.884545: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 3
Result
[[-1.7208811 -3.75401592 6.57920933 6.78571606 -3.69262314 -3.98726892 -15.4478512 17.4316921 1.81103039 8.18319702]]
total time trial 3: 147.40448665618896
2018-11-27 16:08:02.896486: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:08:02.896512: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:08:02.896523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:08:02.896550: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:08:02.896561: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:08:02.896572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:08:02.896589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:08:02.896601: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:08:02.896614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:08:02.896627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:08:02.896639: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:08:02.896651: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:08:02.896665: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:08:02.896676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:08:02.896686: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:08:02.896693: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:08:02.896702: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:08:02.896709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:08:02.896717: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:08:02.896724: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:08:02.896773: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:08:02.896790: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:08:02.896800: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:08:02.896810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:08:02.896821: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:08:02.896831: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:08:02.896841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:08:02.896851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:08:02.896861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:08:02.896871: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:08:02.896881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:08:02.896891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:08:02.896901: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:08:02.896911: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:08:02.896921: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:08:02.896931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:08:02.896942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:08:02.897015: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:08:02.897037: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:08:02.897055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:08:02.897070: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:08:02.897086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:08:02.897105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:08:02.897120: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:08:02.897142: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:08:02.897158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:08:02.897181: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:08:02.897197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:08:02.897219: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:08:02.897236: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:08:02.897251: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:08:02.897273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:08:02.897283: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:08:02.897293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:08:02.897302: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:08:02.897325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:08:02.897335: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:08:02.897344: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:08:02.897353: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:08:02.897360: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:08:02.897366: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:08:02.897383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x98998a0 :: reshape/Reshape/shape [Const]
2018-11-27 16:08:02.897392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899918 :: conv1/Const [Const]
2018-11-27 16:08:02.897400: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899990 :: conv1/pad_const [Const]
2018-11-27 16:08:02.897409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899a08 :: fc1/Reshape/shape [Const]
2018-11-27 16:08:02.897418: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899a80 :: squash/Const [Const]
2018-11-27 16:08:02.897426: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899af8 :: fc2/Const [Const]
2018-11-27 16:08:02.897434: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899b70 :: reshape/Reshape [Reshape]
2018-11-27 16:08:02.897443: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899c28 :: conv1/Conv2D [Conv2D]
2018-11-27 16:08:02.897452: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899ce0 :: conv1/Square [Square]
2018-11-27 16:08:02.897460: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899d78 :: conv1/Pad [Pad]
2018-11-27 16:08:02.897469: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899e30 :: fc1/Reshape [Reshape]
2018-11-27 16:08:02.897488: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899ee8 :: fc1/MatMul [MatMul]
2018-11-27 16:08:02.897497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x9899fa0 :: fc1/Square [Square]
2018-11-27 16:08:02.897506: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x989a038 :: fc2/MatMul [MatMul]
2018-11-27 16:08:02.897570: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:08:02.897617: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 4 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:08:02.897650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:08:02.897684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:08:02.897696: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 4, datatype: 1
2018-11-27 16:08:02.899258: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:08:02.899318: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:08:05z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:08:05.247848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 4
2018-11-27 16:08:05.247902: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:08:05.247913: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 4
2018-11-27 16:08:05.247920: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_4
2018-11-27 16:08:05.248038: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:08:05.248117: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:08:05.248143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:08:05.248170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:08:05.248212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:08:05.248266: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:08:05.248286: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:08:05.248294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:08:05.248301: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:08:05.248307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:08:05.248320: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:08:05.248353: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:08:05.248372: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:08:05.248380: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:08:05.248390: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:08:05.248419: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:08:05.248433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:08:05.248441: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:08:05.248537: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:08:05.248574: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:08:05.248622: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:08:05.248661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:08:05.248687: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:08:05.248697: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:08:05.248705: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:08:05.248761: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:08:05.248794: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:08:05.248809: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:08:05.248835: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:08:05.248870: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:08:05.249524: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:08:05.249579: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:08:05.249619: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:08:05.249668: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:08:05.249798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 4
2018-11-27 16:08:05.249819: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 4
[INFO] 2018-11-28T00:08:05z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:08:05.297347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 4
[INFO] 2018-11-28T00:08:05z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:08:05.297743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 4
2018-11-27 16:08:05.297756: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 4
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 319	[ Parameter_80 ]
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 319	[ Constant_97 ]
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 395	Constant_97 took 415ms
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 319	[ Constant_94 ]
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:08:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 395	Constant_94 took 20156ms
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 319	[ Constant_90 ]
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 395	Constant_90 took 11ms
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 319	[ Constant_83 ]
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 395	Constant_83 took 108ms
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 319	[ Reshape_82 ]
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 395	Reshape_82 took 0ms
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 319	[ Reshape_85 ]
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 395	Reshape_85 took 0ms
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 319	[ Reshape_84 ]
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 395	Reshape_84 took 0ms
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 319	[ Convolution_86 ]
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:08:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:50z src/he_backend.cpp 395	Convolution_86 took 24585ms
[INFO] 2018-11-28T00:08:50z src/he_backend.cpp 319	[ Reshape_87 ]
[INFO] 2018-11-28T00:08:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:08:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:50z src/he_backend.cpp 395	Reshape_87 took 0ms
[INFO] 2018-11-28T00:08:50z src/he_backend.cpp 319	[ Multiply_88 ]
[INFO] 2018-11-28T00:08:50z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:08:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 395	Multiply_88 took 724ms
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 319	[ Pad_91 ]
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 395	Pad_91 took 0ms
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 319	[ Reshape_93 ]
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 395	Reshape_93 took 0ms
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 319	[ Dot_95 ]
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:08:51z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:10:13z src/he_backend.cpp 395	Dot_95 took 82350ms
[INFO] 2018-11-28T00:10:13z src/he_backend.cpp 319	[ Multiply_96 ]
[INFO] 2018-11-28T00:10:13z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:10:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:14z src/he_backend.cpp 395	Multiply_96 took 119ms
[INFO] 2018-11-28T00:10:14z src/he_backend.cpp 319	[ Dot_98 ]
[INFO] 2018-11-28T00:10:14z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:10:14z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:14z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:10:15z src/he_backend.cpp 395	Dot_98 took 1243ms
[INFO] 2018-11-28T00:10:15z src/he_backend.cpp 319	[ Result_99 ]
[INFO] 2018-11-28T00:10:15z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:10:15z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:10:15z src/he_backend.cpp 395	Result_99 took 4ms
2018-11-27 16:10:15.310698: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 4
2018-11-27 16:10:15.665937: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 4
Result
[[-1.71116567 -3.75018501 6.57314205 6.78602 -3.69733024 -3.98763371 -15.44835 17.4321156 1.80302501 8.17671108]]
total time trial 4: 132.77794480323792
2018-11-27 16:10:15.680196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:10:15.680262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:10:15.680294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:10:15.680326: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:10:15.680373: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:10:15.680383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:10:15.680395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:10:15.680405: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:10:15.680417: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:10:15.680430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:10:15.680444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:10:15.680455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:10:15.680465: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:10:15.680474: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:10:15.680483: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:10:15.680490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:10:15.680498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:10:15.680504: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:10:15.680512: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:10:15.680518: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:10:15.680563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:10:15.680581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:10:15.680590: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:10:15.680599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:10:15.680609: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:10:15.680618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:10:15.680626: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:10:15.680635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:10:15.680644: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:10:15.680653: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:10:15.680661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:10:15.680670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:10:15.680682: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:10:15.680690: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:10:15.680699: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:10:15.680708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:10:15.680718: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:10:15.680792: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:10:15.680813: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:10:15.680830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:10:15.680844: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:10:15.680859: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:10:15.680876: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:10:15.680890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:10:15.680910: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:10:15.680924: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:10:15.680946: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:10:15.680961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:10:15.680981: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:10:15.680997: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:10:15.681011: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:10:15.681032: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:10:15.681040: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:10:15.681049: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:10:15.681056: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:10:15.681079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:10:15.681087: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:10:15.681095: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:10:15.681103: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:10:15.681109: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:10:15.681115: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:10:15.681129: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x98964b0 :: reshape/Reshape/shape [Const]
2018-11-27 16:10:15.681137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896528 :: conv1/Const [Const]
2018-11-27 16:10:15.681144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x98965a0 :: conv1/pad_const [Const]
2018-11-27 16:10:15.681151: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896618 :: fc1/Reshape/shape [Const]
2018-11-27 16:10:15.681158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896690 :: squash/Const [Const]
2018-11-27 16:10:15.681165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896708 :: fc2/Const [Const]
2018-11-27 16:10:15.681173: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896780 :: reshape/Reshape [Reshape]
2018-11-27 16:10:15.681180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896838 :: conv1/Conv2D [Conv2D]
2018-11-27 16:10:15.681187: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x98968f0 :: conv1/Square [Square]
2018-11-27 16:10:15.681194: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896988 :: conv1/Pad [Pad]
2018-11-27 16:10:15.681202: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896a40 :: fc1/Reshape [Reshape]
2018-11-27 16:10:15.681209: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896af8 :: fc1/MatMul [MatMul]
2018-11-27 16:10:15.681216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896bb0 :: fc1/Square [Square]
2018-11-27 16:10:15.681223: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x9896c48 :: fc2/MatMul [MatMul]
2018-11-27 16:10:15.681287: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:10:15.681333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 5 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:10:15.681366: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:10:15.681399: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:10:15.681410: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 5, datatype: 1
2018-11-27 16:10:15.683054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:10:15.683076: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:10:17z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:10:17.997350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 5
2018-11-27 16:10:17.997429: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:10:17.997458: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 5
2018-11-27 16:10:17.997480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_5
2018-11-27 16:10:17.997668: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:10:17.997825: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:10:17.997885: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:10:17.997942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:10:17.998048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:10:17.998154: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:10:17.998188: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:10:17.998196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:10:17.998201: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:10:17.998207: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:10:17.998219: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:10:17.998250: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:10:17.998258: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:10:17.998265: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:10:17.998273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:10:17.998300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:10:17.998314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:10:17.998321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:10:17.998416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:10:17.998449: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:10:17.998496: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:10:17.998529: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:10:17.998551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:10:17.998560: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:10:17.998567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:10:17.998624: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:10:17.998652: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:10:17.998665: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:10:17.998678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:10:17.998712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:10:17.999323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:10:17.999376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:10:17.999414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:10:17.999459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:10:17.999587: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 5
2018-11-27 16:10:17.999608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 5
[INFO] 2018-11-28T00:10:17z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:10:18.061392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 5
[INFO] 2018-11-28T00:10:18z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:10:18.062308: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 5
2018-11-27 16:10:18.062351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 5
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 319	[ Parameter_100 ]
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 319	[ Constant_117 ]
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 395	Constant_117 took 291ms
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 319	[ Constant_114 ]
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:10:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 395	Constant_114 took 20089ms
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 319	[ Constant_110 ]
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 395	Constant_110 took 10ms
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 319	[ Constant_103 ]
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 395	Constant_103 took 66ms
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 319	[ Reshape_102 ]
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 395	Reshape_102 took 0ms
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 319	[ Reshape_105 ]
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 395	Reshape_105 took 0ms
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 319	[ Reshape_104 ]
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 395	Reshape_104 took 0ms
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 319	[ Convolution_106 ]
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:10:38z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:11:03z src/he_backend.cpp 395	Convolution_106 took 24842ms
[INFO] 2018-11-28T00:11:03z src/he_backend.cpp 319	[ Reshape_107 ]
[INFO] 2018-11-28T00:11:03z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:11:03z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:11:03z src/he_backend.cpp 395	Reshape_107 took 0ms
[INFO] 2018-11-28T00:11:03z src/he_backend.cpp 319	[ Multiply_108 ]
[INFO] 2018-11-28T00:11:03z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:11:03z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 395	Multiply_108 took 731ms
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 319	[ Pad_111 ]
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 395	Pad_111 took 0ms
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 319	[ Reshape_113 ]
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 395	Reshape_113 took 0ms
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 319	[ Dot_115 ]
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:11:04z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 395	Dot_115 took 86888ms
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 319	[ Multiply_116 ]
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 395	Multiply_116 took 123ms
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 319	[ Dot_118 ]
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:31z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:12:32z src/he_backend.cpp 395	Dot_118 took 1235ms
[INFO] 2018-11-28T00:12:32z src/he_backend.cpp 319	[ Result_119 ]
[INFO] 2018-11-28T00:12:32z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:12:32z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:12:32z src/he_backend.cpp 395	Result_119 took 3ms
2018-11-27 16:12:32.691821: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 5
2018-11-27 16:12:33.063935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 5
Result
[[-1.7345469 -3.75892115 6.58786106 6.78507471 -3.68523574 -3.9866488 -15.4464083 17.4305573 1.82266855 8.19229412]]
total time trial 5: 137.39237213134766
2018-11-27 16:12:33.074508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:12:33.074533: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:12:33.074542: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:12:33.074551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:12:33.074559: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:12:33.074567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:12:33.074579: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:12:33.074596: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:12:33.074606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:12:33.074618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:12:33.074628: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:12:33.074639: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:12:33.074649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:12:33.074658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:12:33.074666: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:12:33.074673: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:12:33.074691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:12:33.074697: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:12:33.074704: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:12:33.074712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:12:33.074759: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:12:33.074775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:12:33.074784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:12:33.074792: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:12:33.074802: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:12:33.074810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:12:33.074819: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:12:33.074827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:12:33.074836: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:12:33.074845: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:12:33.074854: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:12:33.074862: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:12:33.074871: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:12:33.074879: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:12:33.074888: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:12:33.074896: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:12:33.074906: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:12:33.074978: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:12:33.074999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:12:33.075015: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:12:33.075029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:12:33.075044: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:12:33.075061: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:12:33.075076: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:12:33.075096: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:12:33.075110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:12:33.075132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:12:33.075147: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:12:33.075167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:12:33.075183: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:12:33.075197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:12:33.075218: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:12:33.075226: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:12:33.075235: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:12:33.075243: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:12:33.075266: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:12:33.075274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:12:33.075282: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:12:33.075290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:12:33.075296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:12:33.075302: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:12:33.075316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989c9e0 :: reshape/Reshape/shape [Const]
2018-11-27 16:12:33.075324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989ca58 :: conv1/Const [Const]
2018-11-27 16:12:33.075331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989cad0 :: conv1/pad_const [Const]
2018-11-27 16:12:33.075338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989cb48 :: fc1/Reshape/shape [Const]
2018-11-27 16:12:33.075346: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989cbc0 :: squash/Const [Const]
2018-11-27 16:12:33.075353: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989cc38 :: fc2/Const [Const]
2018-11-27 16:12:33.075360: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989ccb0 :: reshape/Reshape [Reshape]
2018-11-27 16:12:33.075368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989cd68 :: conv1/Conv2D [Conv2D]
2018-11-27 16:12:33.075375: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989ce20 :: conv1/Square [Square]
2018-11-27 16:12:33.075382: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989ceb8 :: conv1/Pad [Pad]
2018-11-27 16:12:33.075390: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989cf70 :: fc1/Reshape [Reshape]
2018-11-27 16:12:33.075397: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989d028 :: fc1/MatMul [MatMul]
2018-11-27 16:12:33.075404: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989d0e0 :: fc1/Square [Square]
2018-11-27 16:12:33.075411: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x989d178 :: fc2/MatMul [MatMul]
2018-11-27 16:12:33.075475: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:12:33.075522: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 6 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:12:33.075555: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:12:33.075588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:12:33.075599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 6, datatype: 1
2018-11-27 16:12:33.077389: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:12:33.077408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:12:35z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:12:35.491333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 6
2018-11-27 16:12:35.491379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:12:35.491389: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 6
2018-11-27 16:12:35.491395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_6
2018-11-27 16:12:35.491494: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:12:35.491565: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:12:35.491589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:12:35.491612: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:12:35.491651: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:12:35.491700: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:12:35.491718: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:12:35.491726: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:12:35.491732: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:12:35.491737: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:12:35.491748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:12:35.491779: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:12:35.491787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:12:35.491794: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:12:35.491803: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:12:35.491829: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:12:35.491841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:12:35.491848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:12:35.491944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:12:35.491976: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:12:35.492018: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:12:35.492054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:12:35.492079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:12:35.492088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:12:35.492095: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:12:35.492146: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:12:35.492186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:12:35.492200: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:12:35.492213: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:12:35.492246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:12:35.492949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:12:35.492999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:12:35.493036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:12:35.493083: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:12:35.493210: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 6
2018-11-27 16:12:35.493229: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 6
[INFO] 2018-11-28T00:12:35z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:12:35.535730: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 6
[INFO] 2018-11-28T00:12:35z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:12:35.536361: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 6
2018-11-27 16:12:35.536374: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 6
[INFO] 2018-11-28T00:12:35z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:12:35z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:12:35z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:12:35z src/he_backend.cpp 319	[ Parameter_120 ]
[INFO] 2018-11-28T00:12:35z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:12:35z src/he_backend.cpp 319	[ Constant_137 ]
[INFO] 2018-11-28T00:12:35z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:12:35z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:36z src/he_backend.cpp 395	Constant_137 took 363ms
[INFO] 2018-11-28T00:12:36z src/he_backend.cpp 319	[ Constant_134 ]
[INFO] 2018-11-28T00:12:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:12:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 395	Constant_134 took 19967ms
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 319	[ Constant_130 ]
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 395	Constant_130 took 11ms
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 319	[ Constant_123 ]
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 395	Constant_123 took 59ms
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 319	[ Reshape_122 ]
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 395	Reshape_122 took 0ms
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 319	[ Reshape_125 ]
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 395	Reshape_125 took 0ms
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 319	[ Reshape_124 ]
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 395	Reshape_124 took 0ms
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 319	[ Convolution_126 ]
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:12:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:13:25z src/he_backend.cpp 395	Convolution_126 took 29149ms
[INFO] 2018-11-28T00:13:25z src/he_backend.cpp 319	[ Reshape_127 ]
[INFO] 2018-11-28T00:13:25z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:13:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:13:25z src/he_backend.cpp 395	Reshape_127 took 0ms
[INFO] 2018-11-28T00:13:25z src/he_backend.cpp 319	[ Multiply_128 ]
[INFO] 2018-11-28T00:13:25z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:13:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 395	Multiply_128 took 704ms
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 319	[ Pad_131 ]
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 395	Pad_131 took 0ms
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 319	[ Reshape_133 ]
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 395	Reshape_133 took 0ms
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 319	[ Dot_135 ]
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:13:26z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 395	Dot_135 took 94378ms
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 319	[ Multiply_136 ]
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 395	Multiply_136 took 112ms
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 319	[ Dot_138 ]
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:00z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:15:01z src/he_backend.cpp 395	Dot_138 took 1195ms
[INFO] 2018-11-28T00:15:01z src/he_backend.cpp 319	[ Result_139 ]
[INFO] 2018-11-28T00:15:01z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:15:01z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:15:01z src/he_backend.cpp 395	Result_139 took 4ms
2018-11-27 16:15:01.746297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 6
2018-11-27 16:15:02.349331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 6
Result
[[-1.69935381 -3.74624 6.56557751 6.78663063 -3.70412612 -3.98826098 -15.4500313 17.4333477 1.79274678 8.16882]]
total time trial 6: 149.2818148136139
2018-11-27 16:15:02.360734: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:15:02.360774: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:15:02.360784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:15:02.360793: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:15:02.360801: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:15:02.360811: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:15:02.360826: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:15:02.360836: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:15:02.360848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:15:02.360861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:15:02.360871: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:15:02.360882: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:15:02.360892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:15:02.360901: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:15:02.360909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:15:02.360916: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:15:02.360924: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:15:02.360930: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:15:02.360937: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:15:02.360944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:15:02.361004: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:15:02.361024: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:15:02.361033: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:15:02.361041: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:15:02.361051: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:15:02.361059: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:15:02.361067: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:15:02.361075: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:15:02.361085: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:15:02.361093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:15:02.361102: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:15:02.361110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:15:02.361119: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:15:02.361127: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:15:02.361136: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:15:02.361144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:15:02.361154: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:15:02.361236: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:15:02.361262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:15:02.361280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:15:02.361293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:15:02.361308: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:15:02.361325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:15:02.361339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:15:02.361359: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:15:02.361373: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:15:02.361395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:15:02.361409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:15:02.361430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:15:02.361446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:15:02.361459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:15:02.361480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:15:02.361489: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:15:02.361497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:15:02.361505: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:15:02.361527: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:15:02.361535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:15:02.361542: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:15:02.361550: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:15:02.361556: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:15:02.361562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:15:02.361576: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989a730 :: reshape/Reshape/shape [Const]
2018-11-27 16:15:02.361584: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989a7a8 :: conv1/Const [Const]
2018-11-27 16:15:02.361591: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989a820 :: conv1/pad_const [Const]
2018-11-27 16:15:02.361599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989a898 :: fc1/Reshape/shape [Const]
2018-11-27 16:15:02.361606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989a910 :: squash/Const [Const]
2018-11-27 16:15:02.361613: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989a988 :: fc2/Const [Const]
2018-11-27 16:15:02.361620: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989aa00 :: reshape/Reshape [Reshape]
2018-11-27 16:15:02.361627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989aab8 :: conv1/Conv2D [Conv2D]
2018-11-27 16:15:02.361634: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989ab70 :: conv1/Square [Square]
2018-11-27 16:15:02.361641: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989ac08 :: conv1/Pad [Pad]
2018-11-27 16:15:02.361648: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989acc0 :: fc1/Reshape [Reshape]
2018-11-27 16:15:02.361655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989ad78 :: fc1/MatMul [MatMul]
2018-11-27 16:15:02.361662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989ae30 :: fc1/Square [Square]
2018-11-27 16:15:02.361670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x989aec8 :: fc2/MatMul [MatMul]
2018-11-27 16:15:02.361735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:15:02.361787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 7 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:15:02.361823: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:15:02.361863: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:15:02.361875: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 7, datatype: 1
2018-11-27 16:15:02.363773: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:15:02.363827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:15:04z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:15:04.623286: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 7
2018-11-27 16:15:04.623355: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:15:04.623369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 7
2018-11-27 16:15:04.623384: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_7
2018-11-27 16:15:04.623498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:15:04.623572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:15:04.623596: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:15:04.623619: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:15:04.623659: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:15:04.623709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:15:04.623727: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:15:04.623735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:15:04.623740: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:15:04.623746: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:15:04.623758: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:15:04.623788: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:15:04.623796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:15:04.623802: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:15:04.623811: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:15:04.623838: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:15:04.623850: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:15:04.623857: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:15:04.623950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:15:04.623984: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:15:04.624027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:15:04.624062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:15:04.624085: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:15:04.624094: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:15:04.624101: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:15:04.624153: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:15:04.624181: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:15:04.624194: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:15:04.624207: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:15:04.624241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:15:04.624906: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:15:04.624956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:15:04.624992: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:15:04.625035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:15:04.625156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 7
2018-11-27 16:15:04.625175: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 7
[INFO] 2018-11-28T00:15:04z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:15:04.672743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 7
[INFO] 2018-11-28T00:15:04z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:15:04.673431: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 7
2018-11-27 16:15:04.673477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 7
[INFO] 2018-11-28T00:15:04z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:15:04z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:15:04z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:15:04z src/he_backend.cpp 319	[ Parameter_140 ]
[INFO] 2018-11-28T00:15:04z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:15:04z src/he_backend.cpp 319	[ Constant_157 ]
[INFO] 2018-11-28T00:15:04z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:15:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:05z src/he_backend.cpp 395	Constant_157 took 249ms
[INFO] 2018-11-28T00:15:05z src/he_backend.cpp 319	[ Constant_154 ]
[INFO] 2018-11-28T00:15:05z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:15:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 395	Constant_154 took 20444ms
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 319	[ Constant_150 ]
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 395	Constant_150 took 10ms
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 319	[ Constant_143 ]
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 395	Constant_143 took 103ms
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 319	[ Reshape_142 ]
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 395	Reshape_142 took 0ms
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 319	[ Reshape_145 ]
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 395	Reshape_145 took 0ms
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 319	[ Reshape_144 ]
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 395	Reshape_144 took 0ms
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 319	[ Convolution_146 ]
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:15:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:53z src/he_backend.cpp 395	Convolution_146 took 28006ms
[INFO] 2018-11-28T00:15:53z src/he_backend.cpp 319	[ Reshape_147 ]
[INFO] 2018-11-28T00:15:53z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:15:53z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:53z src/he_backend.cpp 395	Reshape_147 took 0ms
[INFO] 2018-11-28T00:15:53z src/he_backend.cpp 319	[ Multiply_148 ]
[INFO] 2018-11-28T00:15:53z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:15:53z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 395	Multiply_148 took 722ms
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 319	[ Pad_151 ]
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 395	Pad_151 took 0ms
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 319	[ Reshape_153 ]
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 395	Reshape_153 took 0ms
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 319	[ Dot_155 ]
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:15:54z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 395	Dot_155 took 91384ms
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 319	[ Multiply_156 ]
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 395	Multiply_156 took 95ms
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 319	[ Dot_158 ]
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:25z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:17:27z src/he_backend.cpp 395	Dot_158 took 1207ms
[INFO] 2018-11-28T00:17:27z src/he_backend.cpp 319	[ Result_159 ]
[INFO] 2018-11-28T00:17:27z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:17:27z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:17:27z src/he_backend.cpp 395	Result_159 took 3ms
2018-11-27 16:17:27.130493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 7
2018-11-27 16:17:27.494851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 7
Result
[[-1.70223534 -3.74758887 6.56683779 6.78617954 -3.70318627 -3.98841572 -15.4501257 17.4328938 1.79449904 8.17038727]]
total time trial 7: 145.1421082019806
2018-11-27 16:17:27.506376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:17:27.506416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:17:27.506427: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:17:27.506437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:17:27.506446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:17:27.506455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:17:27.506470: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:17:27.506480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:17:27.506492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:17:27.506504: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:17:27.506515: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:17:27.506526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:17:27.506535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:17:27.506544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:17:27.506553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:17:27.506559: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:17:27.506569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:17:27.506575: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:17:27.506583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:17:27.506589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:17:27.506649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:17:27.506669: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:17:27.506678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:17:27.506686: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:17:27.506696: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:17:27.506704: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:17:27.506713: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:17:27.506722: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:17:27.506731: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:17:27.506739: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:17:27.506748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:17:27.506756: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:17:27.506765: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:17:27.506774: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:17:27.506782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:17:27.506791: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:17:27.506801: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:17:27.506886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:17:27.506911: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:17:27.506929: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:17:27.506943: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:17:27.506958: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:17:27.506975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:17:27.506989: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:17:27.507009: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:17:27.507023: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:17:27.507045: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:17:27.507060: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:17:27.507080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:17:27.507096: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:17:27.507110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:17:27.507131: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:17:27.507140: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:17:27.507148: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:17:27.507157: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:17:27.507179: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:17:27.507187: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:17:27.507195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:17:27.507203: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:17:27.507209: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:17:27.507215: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:17:27.507233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988d870 :: reshape/Reshape/shape [Const]
2018-11-27 16:17:27.507241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988d8e8 :: conv1/Const [Const]
2018-11-27 16:17:27.507248: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988d960 :: conv1/pad_const [Const]
2018-11-27 16:17:27.507255: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988d9d8 :: fc1/Reshape/shape [Const]
2018-11-27 16:17:27.507263: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988da50 :: squash/Const [Const]
2018-11-27 16:17:27.507270: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988dac8 :: fc2/Const [Const]
2018-11-27 16:17:27.507277: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988db40 :: reshape/Reshape [Reshape]
2018-11-27 16:17:27.507284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988dbf8 :: conv1/Conv2D [Conv2D]
2018-11-27 16:17:27.507291: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988dcb0 :: conv1/Square [Square]
2018-11-27 16:17:27.507298: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988dd48 :: conv1/Pad [Pad]
2018-11-27 16:17:27.507306: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988de00 :: fc1/Reshape [Reshape]
2018-11-27 16:17:27.507313: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988deb8 :: fc1/MatMul [MatMul]
2018-11-27 16:17:27.507320: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988df70 :: fc1/Square [Square]
2018-11-27 16:17:27.507327: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x988e008 :: fc2/MatMul [MatMul]
2018-11-27 16:17:27.507392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:17:27.507444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 8 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:17:27.507479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:17:27.507519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:17:27.507530: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 8, datatype: 1
2018-11-27 16:17:27.509035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:17:27.509055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:17:29z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:17:29.743894: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 8
2018-11-27 16:17:29.743969: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:17:29.743982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 8
2018-11-27 16:17:29.743997: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_8
2018-11-27 16:17:29.744093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:17:29.744166: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:17:29.744190: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:17:29.744213: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:17:29.744251: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:17:29.744299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:17:29.744317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:17:29.744324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:17:29.744330: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:17:29.744336: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:17:29.744348: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:17:29.744389: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:17:29.744397: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:17:29.744404: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:17:29.744412: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:17:29.744454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:17:29.744467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:17:29.744474: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:17:29.744572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:17:29.744606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:17:29.744648: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:17:29.744682: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:17:29.744706: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:17:29.744715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:17:29.744722: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:17:29.744774: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:17:29.744803: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:17:29.744816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:17:29.744829: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:17:29.744862: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:17:29.745531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:17:29.745580: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:17:29.745615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:17:29.745660: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:17:29.745784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 8
2018-11-27 16:17:29.745803: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 8
[INFO] 2018-11-28T00:17:29z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:17:29.778004: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 8
[INFO] 2018-11-28T00:17:29z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:17:29.778644: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 8
2018-11-27 16:17:29.778672: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 8
[INFO] 2018-11-28T00:17:29z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:17:29z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:17:29z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 319	[ Parameter_160 ]
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 319	[ Constant_177 ]
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 395	Constant_177 took 282ms
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 319	[ Constant_174 ]
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:17:30z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 395	Constant_174 took 20094ms
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 319	[ Constant_170 ]
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 395	Constant_170 took 10ms
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 319	[ Constant_163 ]
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 395	Constant_163 took 79ms
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 319	[ Reshape_162 ]
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 395	Reshape_162 took 0ms
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 319	[ Reshape_165 ]
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 395	Reshape_165 took 0ms
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 319	[ Reshape_164 ]
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 395	Reshape_164 took 0ms
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 319	[ Convolution_166 ]
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:17:50z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:18:17z src/he_backend.cpp 395	Convolution_166 took 27226ms
[INFO] 2018-11-28T00:18:17z src/he_backend.cpp 319	[ Reshape_167 ]
[INFO] 2018-11-28T00:18:17z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:18:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:18:17z src/he_backend.cpp 395	Reshape_167 took 0ms
[INFO] 2018-11-28T00:18:17z src/he_backend.cpp 319	[ Multiply_168 ]
[INFO] 2018-11-28T00:18:17z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:18:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 395	Multiply_168 took 722ms
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 319	[ Pad_171 ]
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 395	Pad_171 took 0ms
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 319	[ Reshape_173 ]
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 395	Reshape_173 took 0ms
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 319	[ Dot_175 ]
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:18:18z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 395	Dot_175 took 90824ms
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 319	[ Multiply_176 ]
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 395	Multiply_176 took 109ms
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 319	[ Dot_178 ]
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:19:49z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:19:50z src/he_backend.cpp 395	Dot_178 took 1250ms
[INFO] 2018-11-28T00:19:50z src/he_backend.cpp 319	[ Result_179 ]
[INFO] 2018-11-28T00:19:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:19:50z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:19:50z src/he_backend.cpp 395	Result_179 took 4ms
2018-11-27 16:19:50.662119: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 8
2018-11-27 16:19:51.032453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 8
Result
[[-1.74370885 -3.76184559 6.5940237 6.7848773 -3.67979646 -3.98617816 -15.4452057 17.4298363 1.8309865 8.19818878]]
total time trial 8: 143.53308629989624
2018-11-27 16:19:51.043199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:19:51.043232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:19:51.043242: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:19:51.043250: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:19:51.043257: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:19:51.043264: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:19:51.043279: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:19:51.043288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:19:51.043316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:19:51.043329: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:19:51.043339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:19:51.043355: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:19:51.043364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:19:51.043373: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:19:51.043382: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:19:51.043388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:19:51.043396: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:19:51.043402: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:19:51.043409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:19:51.043416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:19:51.043478: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:19:51.043498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:19:51.043507: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:19:51.043515: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:19:51.043524: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:19:51.043533: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:19:51.043541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:19:51.043549: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:19:51.043558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:19:51.043567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:19:51.043576: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:19:51.043589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:19:51.043598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:19:51.043606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:19:51.043614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:19:51.043623: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:19:51.043632: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:19:51.043715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:19:51.043739: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:19:51.043758: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:19:51.043772: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:19:51.043786: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:19:51.043803: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:19:51.043817: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:19:51.043837: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:19:51.043851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:19:51.043873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:19:51.043887: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:19:51.043907: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:19:51.043923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:19:51.043937: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:19:51.043958: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:19:51.043966: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:19:51.043974: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:19:51.043982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:19:51.044004: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:19:51.044012: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:19:51.044020: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:19:51.044027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:19:51.044034: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:19:51.044040: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:19:51.044054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc816250 :: reshape/Reshape/shape [Const]
2018-11-27 16:19:51.044062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc8162c8 :: conv1/Const [Const]
2018-11-27 16:19:51.044069: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc816340 :: conv1/pad_const [Const]
2018-11-27 16:19:51.044076: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc8163b8 :: fc1/Reshape/shape [Const]
2018-11-27 16:19:51.044083: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc816430 :: squash/Const [Const]
2018-11-27 16:19:51.044090: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc8164a8 :: fc2/Const [Const]
2018-11-27 16:19:51.044097: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc816520 :: reshape/Reshape [Reshape]
2018-11-27 16:19:51.044104: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc8165d8 :: conv1/Conv2D [Conv2D]
2018-11-27 16:19:51.044111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc816690 :: conv1/Square [Square]
2018-11-27 16:19:51.044119: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc816728 :: conv1/Pad [Pad]
2018-11-27 16:19:51.044126: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc8167e0 :: fc1/Reshape [Reshape]
2018-11-27 16:19:51.044133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc816898 :: fc1/MatMul [MatMul]
2018-11-27 16:19:51.044140: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc816950 :: fc1/Square [Square]
2018-11-27 16:19:51.044147: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0xc8169e8 :: fc2/MatMul [MatMul]
2018-11-27 16:19:51.044210: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:19:51.044262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 9 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:19:51.044297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:19:51.044340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:19:51.044351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 9, datatype: 1
2018-11-27 16:19:51.045617: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:19:51.045680: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:19:53z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:19:53.306827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 9
2018-11-27 16:19:53.306889: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:19:53.306900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 9
2018-11-27 16:19:53.306908: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_9
2018-11-27 16:19:53.307027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:19:53.307099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:19:53.307122: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:19:53.307145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:19:53.307184: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:19:53.307231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:19:53.307249: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:19:53.307257: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:19:53.307262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:19:53.307268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:19:53.307280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:19:53.307310: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:19:53.307317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:19:53.307324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:19:53.307332: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:19:53.307359: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:19:53.307371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:19:53.307378: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:19:53.307471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:19:53.307504: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:19:53.307546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:19:53.307579: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:19:53.307602: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:19:53.307611: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:19:53.307618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:19:53.307667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:19:53.307695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:19:53.307708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:19:53.307721: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:19:53.307753: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:19:53.308383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:19:53.308430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:19:53.308465: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:19:53.308507: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:19:53.308628: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 9
2018-11-27 16:19:53.308646: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 9
[INFO] 2018-11-28T00:19:53z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:19:53.351747: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 9
[INFO] 2018-11-28T00:19:53z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:19:53.352642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 9
2018-11-27 16:19:53.352677: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 9
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 319	[ Parameter_180 ]
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 319	[ Constant_197 ]
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 395	Constant_197 took 264ms
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 319	[ Constant_194 ]
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:19:53z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 395	Constant_194 took 21350ms
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 319	[ Constant_190 ]
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 395	Constant_190 took 10ms
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 319	[ Constant_183 ]
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 395	Constant_183 took 81ms
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 319	[ Reshape_182 ]
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 395	Reshape_182 took 0ms
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 319	[ Reshape_185 ]
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 395	Reshape_185 took 0ms
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 319	[ Reshape_184 ]
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 395	Reshape_184 took 0ms
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 319	[ Convolution_186 ]
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:20:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 395	Convolution_186 took 29868ms
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 319	[ Reshape_187 ]
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 395	Reshape_187 took 0ms
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 319	[ Multiply_188 ]
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 395	Multiply_188 took 727ms
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 319	[ Pad_191 ]
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 395	Pad_191 took 0ms
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 319	[ Reshape_193 ]
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 395	Reshape_193 took 0ms
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 319	[ Dot_195 ]
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:20:45z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:22:22z src/he_backend.cpp 395	Dot_195 took 97089ms
[INFO] 2018-11-28T00:22:22z src/he_backend.cpp 319	[ Multiply_196 ]
[INFO] 2018-11-28T00:22:22z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:22:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:23z src/he_backend.cpp 395	Multiply_196 took 130ms
[INFO] 2018-11-28T00:22:23z src/he_backend.cpp 319	[ Dot_198 ]
[INFO] 2018-11-28T00:22:23z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:22:23z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:23z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:22:24z src/he_backend.cpp 395	Dot_198 took 1232ms
[INFO] 2018-11-28T00:22:24z src/he_backend.cpp 319	[ Result_199 ]
[INFO] 2018-11-28T00:22:24z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:22:24z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:22:24z src/he_backend.cpp 395	Result_199 took 3ms
2018-11-27 16:22:24.353953: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 9
2018-11-27 16:22:24.786706: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 9
Result
[[-1.73539484 -3.75877476 6.58882284 6.78520584 -3.68405986 -3.98647285 -15.445837 17.430418 1.82402623 8.19282722]]
total time trial 9: 153.75088334083557
2018-11-27 16:22:24.798546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 16:22:24.798583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 16:22:24.798609: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 16:22:24.798617: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 16:22:24.798627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 16:22:24.798644: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 16:22:24.798659: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 16:22:24.798669: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 16:22:24.798682: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 16:22:24.798694: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 16:22:24.798703: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 16:22:24.798714: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 16:22:24.798723: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 16:22:24.798732: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 16:22:24.798742: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 16:22:24.798748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 16:22:24.798756: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 16:22:24.798762: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 16:22:24.798770: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 16:22:24.798776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:22:24.798836: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 16:22:24.798856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 16:22:24.798865: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 16:22:24.798873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 16:22:24.798883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 16:22:24.798891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 16:22:24.798900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 16:22:24.798908: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 16:22:24.798917: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 16:22:24.798926: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 16:22:24.798934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 16:22:24.798942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 16:22:24.798950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 16:22:24.798959: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 16:22:24.798967: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 16:22:24.798975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 16:22:24.798985: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 16:22:24.799068: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 16:22:24.799094: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 16:22:24.799112: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 16:22:24.799126: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 16:22:24.799141: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 16:22:24.799158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 16:22:24.799172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 16:22:24.799193: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 16:22:24.799207: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 16:22:24.799230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 16:22:24.799244: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 16:22:24.799264: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 16:22:24.799280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 16:22:24.799294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 16:22:24.799315: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:22:24.799324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:22:24.799332: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:22:24.799339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:22:24.799362: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 16:22:24.799371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 16:22:24.799379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 16:22:24.799387: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 16:22:24.799393: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 16:22:24.799399: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 16:22:24.799414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc812fd0 :: reshape/Reshape/shape [Const]
2018-11-27 16:22:24.799422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc813048 :: conv1/Const [Const]
2018-11-27 16:22:24.799430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc8130c0 :: conv1/pad_const [Const]
2018-11-27 16:22:24.799437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc813138 :: fc1/Reshape/shape [Const]
2018-11-27 16:22:24.799444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc8131b0 :: squash/Const [Const]
2018-11-27 16:22:24.799452: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc813228 :: fc2/Const [Const]
2018-11-27 16:22:24.799458: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc8132a0 :: reshape/Reshape [Reshape]
2018-11-27 16:22:24.799466: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc813358 :: conv1/Conv2D [Conv2D]
2018-11-27 16:22:24.799473: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc813410 :: conv1/Square [Square]
2018-11-27 16:22:24.799480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc8134a8 :: conv1/Pad [Pad]
2018-11-27 16:22:24.799487: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc813560 :: fc1/Reshape [Reshape]
2018-11-27 16:22:24.799494: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc813618 :: fc1/MatMul [MatMul]
2018-11-27 16:22:24.799501: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc8136d0 :: fc1/Square [Square]
2018-11-27 16:22:24.799508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xc813768 :: fc2/MatMul [MatMul]
2018-11-27 16:22:24.799572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 16:22:24.799625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 10 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 16:22:24.799661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to fc2/Print[0] in -1, datatype: 1
2018-11-27 16:22:24.799703: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to fc2/Print[1] in -1, datatype: 1
2018-11-27 16:22:24.799714: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 10, datatype: 1
2018-11-27 16:22:24.801663: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 16:22:24.801685: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-28T00:22:27z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 16:22:27.200395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 10
2018-11-27 16:22:27.200467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 16:22:27.200479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 10
2018-11-27 16:22:27.200491: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_10
2018-11-27 16:22:27.200588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 16:22:27.200661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 16:22:27.200685: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 16:22:27.200708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 16:22:27.200747: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 16:22:27.200795: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 16:22:27.200814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 16:22:27.200821: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 16:22:27.200827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 16:22:27.200833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 16:22:27.200844: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 16:22:27.200874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 16:22:27.200882: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 16:22:27.200889: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 16:22:27.200897: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 16:22:27.200923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 16:22:27.200935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 16:22:27.200942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 16:22:27.201035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 16:22:27.201068: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 16:22:27.201111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 16:22:27.201146: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 16:22:27.201169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 16:22:27.201178: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 16:22:27.201185: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 16:22:27.201235: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 16:22:27.201265: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 16:22:27.201278: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 16:22:27.201291: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 16:22:27.201323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 16:22:27.202002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 16:22:27.202052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 16:22:27.202087: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 16:22:27.202131: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 16:22:27.202254: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 10
2018-11-27 16:22:27.202273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 10
[INFO] 2018-11-28T00:22:27z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 16:22:27.242599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 10
[INFO] 2018-11-28T00:22:27z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 16:22:27.243269: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 10
2018-11-27 16:22:27.243285: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 10
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 259	Encrypting model
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 319	[ Parameter_200 ]
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 319	[ Constant_217 ]
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 395	Constant_217 took 278ms
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 319	[ Constant_214 ]
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:22:27z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 395	Constant_214 took 20293ms
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 319	[ Constant_210 ]
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 395	Constant_210 took 10ms
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 319	[ Constant_203 ]
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 395	Constant_203 took 77ms
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 319	[ Reshape_202 ]
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 395	Reshape_202 took 0ms
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 319	[ Reshape_205 ]
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 395	Reshape_205 took 0ms
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 319	[ Reshape_204 ]
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 395	Reshape_204 took 0ms
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 319	[ Convolution_206 ]
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:22:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:23:15z src/he_backend.cpp 395	Convolution_206 took 27407ms
[INFO] 2018-11-28T00:23:15z src/he_backend.cpp 319	[ Reshape_207 ]
[INFO] 2018-11-28T00:23:15z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:23:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:23:15z src/he_backend.cpp 395	Reshape_207 took 0ms
[INFO] 2018-11-28T00:23:15z src/he_backend.cpp 319	[ Multiply_208 ]
[INFO] 2018-11-28T00:23:15z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:23:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 395	Multiply_208 took 723ms
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 319	[ Pad_211 ]
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 395	Pad_211 took 0ms
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 319	[ Reshape_213 ]
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 395	Reshape_213 took 0ms
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 319	[ Dot_215 ]
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:23:16z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 395	Dot_215 took 92816ms
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 319	[ Multiply_216 ]
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 395	Multiply_216 took 81ms
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 319	[ Dot_218 ]
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-28T00:24:49z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-28T00:24:50z src/he_backend.cpp 395	Dot_218 took 1271ms
[INFO] 2018-11-28T00:24:50z src/he_backend.cpp 319	[ Result_219 ]
[INFO] 2018-11-28T00:24:50z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-28T00:24:50z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-28T00:24:50z src/he_backend.cpp 395	Result_219 took 3ms
2018-11-27 16:24:50.494128: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 10
2018-11-27 16:24:50.864535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 10
Result
[[-1.70264912 -3.74773431 6.56720209 6.78621483 -3.70291877 -3.988343 -15.4500494 17.4329491 1.79493177 8.17080307]]
total time trial 10: 146.07317852973938
/nfs/site/home/fboemer/repos/he-transformer/experiments/CryptoNets
(he3) ➜  CryptoNets git:(fboemer/cryptonets-timings) ✗